%% bare_jrnl.tex
%% V1.4b
%% 2015/08/26
%% by Michael Shell
%% see http://www.michaelshell.org/
%% for current contact information.
%%
%% This is a skeleton file demonstrating the use of IEEEtran.cls
%% (requires IEEEtran.cls version 1.8b or later) with an IEEE
%% journal paper.
%%
%% Support sites:
%% http://www.michaelshell.org/tex/ieeetran/
%% http://www.ctan.org/pkg/ieeetran
%% and
%% http://www.ieee.org/

%%*************************************************************************
%% Legal Notice:
%% This code is offered as-is without any warranty either expressed or
%% implied; without even the implied warranty of MERCHANTABILITY or
%% FITNESS FOR A PARTICULAR PURPOSE! 
%% User assumes all risk.
%% In no event shall the IEEE or any contributor to this code be liable for
%% any damages or losses, including, but not limited to, incidental,
%% consequential, or any other damages, resulting from the use or misuse
%% of any information contained here.
%%
%% All comments are the opinions of their respective authors and are not
%% necessarily endorsed by the IEEE.
%%
%% This work is distributed under the LaTeX Project Public License (LPPL)
%% ( http://www.latex-project.org/ ) version 1.3, and may be freely used,
%% distributed and modified. A copy of the LPPL, version 1.3, is included
%% in the base LaTeX documentation of all distributions of LaTeX released
%% 2003/12/01 or later.
%% Retain all contribution notices and credits.
%% ** Modified files should be clearly indicated as such, including  **
%% ** renaming them and changing author support contact information. **
%%*************************************************************************


% *** Authors should verify (and, if needed, correct) their LaTeX system  ***
% *** with the testflow diagnostic prior to trusting their LaTeX platform ***
% *** with production work. The IEEE's font choices and paper sizes can   ***
% *** trigger bugs that do not appear when using other class files.       ***                          ***
% The testflow support page is at:
% http://www.michaelshell.org/tex/testflow/



\documentclass[journal]{IEEEtran}
%
% If IEEEtran.cls has not been installed into the LaTeX system files,
% manually specify the path to it like:
% \documentclass[journal]{../sty/IEEEtran}





% Some very useful LaTeX packages include:
% (uncomment the ones you want to load)
\usepackage[spanish, es-tabla]{babel}
\usepackage[utf8]{inputenc}
\usepackage{url}
\usepackage{minted}
\setminted{fontsize=\small,baselinestretch=1}
\usepackage{listings}
\usepackage{subcaption}
\renewcommand\listingscaption{CÃ³digo}
\newenvironment{code}{\captionsetup{type=listing}}{\par\addvspace{\baselineskip}}
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{calc,patterns,angles,quotes}
\usetikzlibrary{babel}

% *** MISC UTILITY PACKAGES ***
%
%\usepackage{ifpdf}
% Heiko Oberdiek's ifpdf.sty is very useful if you need conditional
% compilation based on whether the output is pdf or dvi.
% usage:
% \ifpdf
%   % pdf code
% \else
%   % dvi code
% \fi
% The latest version of ifpdf.sty can be obtained from:
% http://www.ctan.org/pkg/ifpdf
% Also, note that IEEEtran.cls V1.7 and later provides a builtin
% \ifCLASSINFOpdf conditional that works the same way.
% When switching from latex to pdflatex and vice-versa, the compiler may
% have to be run twice to clear warning/error messages.






% *** CITATION PACKAGES ***
%
%\usepackage{cite}
% cite.sty was written by Donald Arseneau
% V1.6 and later of IEEEtran pre-defines the format of the cite.sty package
% \cite{} output to follow that of the IEEE. Loading the cite package will
% result in citation numbers being automatically sorted and properly
% "compressed/ranged". e.g., [1], [9], [2], [7], [5], [6] without using
% cite.sty will become [1], [2], [5]--[7], [9] using cite.sty. cite.sty's
% \cite will automatically add leading space, if needed. Use cite.sty's
% noadjust option (cite.sty V3.8 and later) if you want to turn this off
% such as if a citation ever needs to be enclosed in parenthesis.
% cite.sty is already installed on most LaTeX systems. Be sure and use
% version 5.0 (2009-03-20) and later if using hyperref.sty.
% The latest version can be obtained at:
% http://www.ctan.org/pkg/cite
% The documentation is contained in the cite.sty file itself.






% *** GRAPHICS RELATED PACKAGES ***
%
\ifCLASSINFOpdf
  % \usepackage[pdftex]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../pdf/}{../jpeg/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.pdf,.jpeg,.png}
\else
  % or other class option (dvipsone, dvipdf, if not using dvips). graphicx
  % will default to the driver specified in the system graphics.cfg if no
  % driver is specified.
  % \usepackage[dvips]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../eps/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.eps}
\fi
% graphicx was written by David Carlisle and Sebastian Rahtz. It is
% required if you want graphics, photos, etc. graphicx.sty is already
% installed on most LaTeX systems. The latest version and documentation
% can be obtained at: 
% http://www.ctan.org/pkg/graphicx
% Another good source of documentation is "Using Imported Graphics in
% LaTeX2e" by Keith Reckdahl which can be found at:
% http://www.ctan.org/pkg/epslatex
%
% latex, and pdflatex in dvi mode, support graphics in encapsulated
% postscript (.eps) format. pdflatex in pdf mode supports graphics
% in .pdf, .jpeg, .png and .mps (metapost) formats. Users should ensure
% that all non-photo figures use a vector format (.eps, .pdf, .mps) and
% not a bitmapped formats (.jpeg, .png). The IEEE frowns on bitmapped formats
% which can result in "jaggedy"/blurry rendering of lines and letters as
% well as large increases in file sizes.
%
% You can find documentation about the pdfTeX application at:
% http://www.tug.org/applications/pdftex





% *** MATH PACKAGES ***
%
%\usepackage{amsmath}
% A popular package from the American Mathematical Society that provides
% many useful and powerful commands for dealing with mathematics.
%
% Note that the amsmath package sets \interdisplaylinepenalty to 10000
% thus preventing page breaks from occurring within multiline equations. Use:
%\interdisplaylinepenalty=2500
% after loading amsmath to restore such page breaks as IEEEtran.cls normally
% does. amsmath.sty is already installed on most LaTeX systems. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/pkg/amsmath





% *** SPECIALIZED LIST PACKAGES ***
%
%\usepackage{algorithmic}
% algorithmic.sty was written by Peter Williams and Rogerio Brito.
% This package provides an algorithmic environment fo describing algorithms.
% You can use the algorithmic environment in-text or within a figure
% environment to provide for a floating algorithm. Do NOT use the algorithm
% floating environment provided by algorithm.sty (by the same authors) or
% algorithm2e.sty (by Christophe Fiorio) as the IEEE does not use dedicated
% algorithm float types and packages that provide these will not provide
% correct IEEE style captions. The latest version and documentation of
% algorithmic.sty can be obtained at:
% http://www.ctan.org/pkg/algorithms
% Also of interest may be the (relatively newer and more customizable)
% algorithmicx.sty package by Szasz Janos:
% http://www.ctan.org/pkg/algorithmicx




% *** ALIGNMENT PACKAGES ***
%
%\usepackage{array}
% Frank Mittelbach's and David Carlisle's array.sty patches and improves
% the standard LaTeX2e array and tabular environments to provide better
% appearance and additional user controls. As the default LaTeX2e table
% generation code is lacking to the point of almost being broken with
% respect to the quality of the end results, all users are strongly
% advised to use an enhanced (at the very least that provided by array.sty)
% set of table tools. array.sty is already installed on most systems. The
% latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/array


% IEEEtran contains the IEEEeqnarray family of commands that can be used to
% generate multiline equations as well as matrices, tables, etc., of high
% quality.




% *** SUBFIGURE PACKAGES ***
%\ifCLASSOPTIONcompsoc
%  \usepackage[caption=false,font=normalsize,labelfont=sf,textfont=sf]{subfig}
%\else
%  \usepackage[caption=false,font=footnotesize]{subfig}
%\fi
% subfig.sty, written by Steven Douglas Cochran, is the modern replacement
% for subfigure.sty, the latter of which is no longer maintained and is
% incompatible with some LaTeX packages including fixltx2e. However,
% subfig.sty requires and automatically loads Axel Sommerfeldt's caption.sty
% which will override IEEEtran.cls' handling of captions and this will result
% in non-IEEE style figure/table captions. To prevent this problem, be sure
% and invoke subfig.sty's "caption=false" package option (available since
% subfig.sty version 1.3, 2005/06/28) as this is will preserve IEEEtran.cls
% handling of captions.
% Note that the Computer Society format requires a larger sans serif font
% than the serif footnote size font used in traditional IEEE formatting
% and thus the need to invoke different subfig.sty package options depending
% on whether compsoc mode has been enabled.
%
% The latest version and documentation of subfig.sty can be obtained at:
% http://www.ctan.org/pkg/subfig




% *** FLOAT PACKAGES ***
%
%\usepackage{fixltx2e}
% fixltx2e, the successor to the earlier fix2col.sty, was written by
% Frank Mittelbach and David Carlisle. This package corrects a few problems
% in the LaTeX2e kernel, the most notable of which is that in current
% LaTeX2e releases, the ordering of single and double column floats is not
% guaranteed to be preserved. Thus, an unpatched LaTeX2e can allow a
% single column figure to be placed prior to an earlier double column
% figure.
% Be aware that LaTeX2e kernels dated 2015 and later have fixltx2e.sty's
% corrections already built into the system in which case a warning will
% be issued if an attempt is made to load fixltx2e.sty as it is no longer
% needed.
% The latest version and documentation can be found at:
% http://www.ctan.org/pkg/fixltx2e


%\usepackage{stfloats}
% stfloats.sty was written by Sigitas Tolusis. This package gives LaTeX2e
% the ability to do double column floats at the bottom of the page as well
% as the top. (e.g., "\begin{figure*}[!b]" is not normally possible in
% LaTeX2e). It also provides a command:
%\fnbelowfloat
% to enable the placement of footnotes below bottom floats (the standard
% LaTeX2e kernel puts them above bottom floats). This is an invasive package
% which rewrites many portions of the LaTeX2e float routines. It may not work
% with other packages that modify the LaTeX2e float routines. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/pkg/stfloats
% Do not use the stfloats baselinefloat ability as the IEEE does not allow
% \baselineskip to stretch. Authors submitting work to the IEEE should note
% that the IEEE rarely uses double column equations and that authors should try
% to avoid such use. Do not be tempted to use the cuted.sty or midfloat.sty
% packages (also by Sigitas Tolusis) as the IEEE does not format its papers in
% such ways.
% Do not attempt to use stfloats with fixltx2e as they are incompatible.
% Instead, use Morten Hogholm'a dblfloatfix which combines the features
% of both fixltx2e and stfloats:
%
% \usepackage{dblfloatfix}
% The latest version can be found at:
% http://www.ctan.org/pkg/dblfloatfix




%\ifCLASSOPTIONcaptionsoff
%  \usepackage[nomarkers]{endfloat}
% \let\MYoriglatexcaption\caption
% \renewcommand{\caption}[2][\relax]{\MYoriglatexcaption[#2]{#2}}
%\fi
% endfloat.sty was written by James Darrell McCauley, Jeff Goldberg and 
% Axel Sommerfeldt. This package may be useful when used in conjunction with 
% IEEEtran.cls'  captionsoff option. Some IEEE journals/societies require that
% submissions have lists of figures/tables at the end of the paper and that
% figures/tables without any captions are placed on a page by themselves at
% the end of the document. If needed, the draftcls IEEEtran class option or
% \CLASSINPUTbaselinestretch interface can be used to increase the line
% spacing as well. Be sure and use the nomarkers option of endfloat to
% prevent endfloat from "marking" where the figures would have been placed
% in the text. The two hack lines of code above are a slight modification of
% that suggested by in the endfloat docs (section 8.4.1) to ensure that
% the full captions always appear in the list of figures/tables - even if
% the user used the short optional argument of \caption[]{}.
% IEEE papers do not typically make use of \caption[]'s optional argument,
% so this should not be an issue. A similar trick can be used to disable
% captions of packages such as subfig.sty that lack options to turn off
% the subcaptions:
% For subfig.sty:
% \let\MYorigsubfloat\subfloat
% \renewcommand{\subfloat}[2][\relax]{\MYorigsubfloat[]{#2}}
% However, the above trick will not work if both optional arguments of
% the \subfloat command are used. Furthermore, there needs to be a
% description of each subfigure *somewhere* and endfloat does not add
% subfigure captions to its list of figures. Thus, the best approach is to
% avoid the use of subfigure captions (many IEEE journals avoid them anyway)
% and instead reference/explain all the subfigures within the main caption.
% The latest version of endfloat.sty and its documentation can obtained at:
% http://www.ctan.org/pkg/endfloat
%
% The IEEEtran \ifCLASSOPTIONcaptionsoff conditional can also be used
% later in the document, say, to conditionally put the References on a 
% page by themselves.




% *** PDF, URL AND HYPERLINK PACKAGES ***
%
%\usepackage{url}
% url.sty was written by Donald Arseneau. It provides better support for
% handling and breaking URLs. url.sty is already installed on most LaTeX
% systems. The latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/url
% Basically, \url{my_url_here}.




% *** Do not adjust lengths that control margins, column widths, etc. ***
% *** Do not use packages that alter fonts (such as pslatex).         ***
% There should be no need to do such things with IEEEtran.cls V1.6 and later.
% (Unless specifically asked to do so by the journal or conference you plan
% to submit to, of course. )


% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}


\begin{document}
%
% paper title
% Titles are generally capitalized except for words such as a, an, and, as,
% at, but, by, for, in, nor, of, on, or, the, to and up, which are usually
% not capitalized unless they are the first or last word of the title.
% Linebreaks \\ can be used within to get better formatting as desired.
% Do not put math or special symbols in the title.
\title{Estudio de La OscilaciÃ³n de un PÃ©ndulo}
%
%
% author names and IEEE memberships
% note positions of commas and nonbreaking spaces ( ~ ) LaTeX will not break
% a structure at a ~ so this keeps an author's name from being broken across
% two lines.
% use \thanks{} to gain access to the first footnote area
% a separate \thanks must be used for each paragraph as LaTeX2e's \thanks
% was not built to handle multiple paragraphs
%

\author{Alberto GarcÃ­a GarcÃ­a\\ (48718198-N)\\ \texttt{agg180@alu.ua.es} % <-this % stops a space
\thanks{}%
}

% note the % following the last \IEEEmembership and also \thanks - 
% these prevent an unwanted space from occurring between the last author name
% and the end of the author line. i.e., if you had this:
% 
% \author{....lastname \thanks{...} \thanks{...} }
%                     ^------------^------------^----Do not want these spaces!
%
% a space would be appended to the last name and could cause every name on that
% line to be shifted left slightly. This is one of those "LaTeX things". For
% instance, "\textbf{A} \textbf{B}" will typeset as "A B" not "AB". To get
% "AB" then you have to do: "\textbf{A}\textbf{B}"
% \thanks is no different in this regard, so shield the last } of each \thanks
% that ends a line with a % and do not let a space in before the next \thanks.
% Spaces after \IEEEmembership other than the last one are OK (and needed) as
% you are supposed to have spaces between the names. For what it is worth,
% this is a minor point as most people would not even notice if the said evil
% space somehow managed to creep in.



% The paper headers
\markboth{FÃ­sica I -- Grado en FÃ­sica -- 2018-2019}%
{}
% The only time the second header will appear is for the odd numbered pages
% after the title page when using the twoside option.
% 
% *** Note that you probably will NOT want to include the author's ***
% *** name in the headers of peer review papers.                   ***
% You can use \ifCLASSOPTIONpeerreview for conditional compilation here if
% you desire.




% If you want to put a publisher's ID mark on the page you can do it like
% this:
%\IEEEpubid{0000--0000/00\$00.00~\copyright~2015 IEEE}
% Remember, if you use this you must call \IEEEpubidadjcol in the second
% column for its text to clear the IEEEpubid mark.



% use for special paper notices
%\IEEEspecialpapernotice{(Invited Paper)}




% make the title area
\maketitle

% As a general rule, do not put math, special symbols or citations
% in the abstract or keywords.
\begin{abstract}
En esta segunda prÃ¡ctica de la asignatura FÃ­sica I del Grado en FÃ­sica (curso acadÃ©mico 2018-2019) estudiaremos la oscilaciÃ³n de un pÃ©ndulo. Para ello consideraremos que el pÃ©ndulo posee una masa y longitud preestablecidas y que se deja caer desde el reposo al apartarlo de su posiciÃ³n de equilibrio en cierta medida. En primer lugar, obtendremos las ecuaciones diferenciales que permiten calcular los diferentes componentes del pÃ©ndulo. Seguidamente resolveremos
  dichas ecuaciones con un mÃ³dulo de integraciÃ³n numÃ©rica para calcular la amplitud, la velocidad angular y la tensiÃ³n de la cuerda. Con tal resoluciÃ³n, estudiaremos la dependencia entre el perÃ­odo de oscilaciÃ³n y la amplitud inicial. TambiÃ©n compararemos los resultados numÃ©ricos obtenidos anteriormente con la soluciÃ³n analÃ­tica. Por Ãºltimo, introduciremos un tÃ©rmino de rozamiento y estudiaremos su efecto sobre el pÃ©ndulo y su perÃ­odo.

El cÃ³digo Python que implementa los modelos matemÃ¡ticos asÃ­ como las rutinas de visualizaciÃ³n para la resoluciÃ³n de este ejercicio se adjunta con este informe y ademÃ¡s puede ser consultado en el siguiente repositorio online \footnote{\url{https://github.com/Blitzman/physics}}.
\end{abstract}


% For peer review papers, you can put extra information on the cover
% page as needed:
% \ifCLASSOPTIONpeerreview
% \begin{center} \bfseries EDICS Category: 3-BBND \end{center}
% \fi
%
% For peerreview papers, this IEEEtran command inserts a page break and
% creates the second title. It will be ignored for other modes.
\IEEEpeerreviewmaketitle

\section{IntroducciÃ³n}

\IEEEPARstart{E}{l} pÃ©ndulo es un cuerpo suspendido por una cuerda de un punto alrededor del cual oscila por acciÃ³n de la fuerza gravitatoria. Podemos hablar de pÃ©ndulo ideal cuando se asume que la cuerda no tiene masa y que el cuerpo carece de fricciÃ³n o rozamiento con el medio. Es decir, que el pÃ©ndulo oscilarÃ¡ indefinidamente.

En esta prÃ¡ctica consideraremos un pÃ©ndulo de longitud $l$ y masa $m$ que se aparta de su posiciÃ³n de equilibrio un Ã¡ngulo $\theta_0$ y se deja caer desde el reposo (tal y como se muestra en la Figura \ref{fig:pendulum}). Inicialmente supondremos un pÃ©ndulo ideal para posteriormente introducir fuerzas amortiguadoras y estudiar el efecto de las mismas.

\begin{figure}[!hbt]
  \centering
\begin{tikzpicture}
    % save length of g-vector and theta to macros
    \pgfmathsetmacro{\Gvec}{1.5}
    \pgfmathsetmacro{\myAngle}{45}
    % calculate lengths of vector components
    \pgfmathsetmacro{\Gcos}{\Gvec*cos(\myAngle)}
    \pgfmathsetmacro{\Gsin}{\Gvec*sin(\myAngle)}

    \coordinate (centro) at (0,0);
    \draw[dashed,gray,-] (centro) -- ++ (0,-3.5) node (mary) [black,below]{$ $};
    \draw[thick] (centro) -- ++(270+\myAngle:3) coordinate (bob)
      node[midway, above right]{$l$};
    \pic [olive, draw, ->, "$\theta$", angle eccentricity=1.5] {angle = mary--centro--bob};
    \draw [blue,-stealth] (bob) -- ($(bob)!\Gcos cm!(centro)$)
      node[midway, above right]{$T$};
    \draw [-stealth] (bob) -- ($(bob)!-\Gcos cm!(centro)$)
      coordinate (gcos)
      node[midway,above right] {$mg\cos\theta$};
    \draw [-stealth] (bob) -- ($(bob)!\Gsin cm!90:(centro)$)
      coordinate (gsin)
      node[midway,above left] {$mg\sin\theta$};
    \draw [red,-stealth] ($(bob)!1.0*\Gsin cm!90:(centro)$) -- ($(bob)!2.0*\Gsin cm!90:(centro)$)
      coordinate (gsin)
      node[left] {$\vec{v}$};
    \draw [-stealth] (bob) -- ++(0,-\Gvec)
      coordinate (g)
      node[near end,left] {$g$};
    \pic [olive, draw, ->, "$\theta$", angle eccentricity=1.5] {angle = g--bob--gcos};
    \filldraw [fill=black!40,draw=black] (bob) circle[radius=0.1];
\end{tikzpicture}
  \caption{Diagrama de cuerpo libre de un pÃ©ndulo de masa $m$ y cuerda de longitud $l$ apartado un Ã¡ngulo $theta$ de la vertical.}
  \label{fig:pendulum}
\end{figure}

\section{Ecuaciones Diferenciales del PÃ©ndulo}

Las ecuaciones diferenciales que permiten calcular el Ã¡ngulo $\theta$ y la tensiÃ³n de la cuerda $T$ como funciÃ³n del tiempo pueden obtenerse a partir de las ecuaciones de Newton que rigen el funcionamiento del pÃ©ndulo ideal.

El sumatorio de fuerzas sobre el eje radial ($y$) es

\begin{equation}
  \sum F_y = T - Pcos(\theta) = 0 \Rightarrow T = mgcos(\theta)~.
\end{equation}

Puesto que $\theta$ depende del tiempo (ya que la posiciÃ³n o Ã¡ngulo del pÃ©ndulo varÃ­a con el mismo), hemos encontrado la ecuaciÃ³n que permite calcular la tensiÃ³n de la cuerda

\begin{equation}
  T(\theta(t)) = mgcos(\theta(t)) ~ [N]~.
\end{equation}

Por otro lado, en el eje tangencial o angular es

\begin{equation}
  \sum F_x = -Psin(\theta) = ma \Rightarrow -mgsin(\theta) = ma_\theta
\end{equation}
\begin{equation}
  \Rightarrow -gsin(\theta) = a_\theta
\end{equation}

Toda la aceleraciÃ³n producida en el eje tangencial podemos expresarla en coordenadas polares (teniendo en cuenta que el radio $l$ es constante) como

\begin{equation}
  a_\theta = 2\displaystyle\frac{dl}{dt}\displaystyle\frac{d\theta}{dt} + l\displaystyle\frac{d^2\theta}{dt^2} = l\displaystyle\frac{d^2\theta}{dt^2}~.
\end{equation}

Reemplazando la aceleraciÃ³n obtenida y reorganizando los tÃ©rminos teniendo en cuenta la aproximaciÃ³n de pequeÃ±as oscilaciones ($sin(\theta) \sim \theta$) obtenemos

\begin{equation}
  \displaystyle\frac{d^2\theta}{dt^2} + \displaystyle\frac{g}{l}sin(\theta) = 0 ~.
\end{equation}
\begin{equation}
  \displaystyle\frac{d^2\theta}{dt^2} + \displaystyle\frac{g}{l}\theta = 0 ~.
\end{equation}

Esta ecuaciÃ³n describe un movimiento armÃ³nico simple cuya soluciÃ³n analÃ­tica para la posiciÃ³n o Ã¡ngulo es

\begin{equation}
  \theta(t) = \theta_0 cos(\sqrt{\displaystyle\frac{g}{l}}t) = \theta_0 cos(\omega_0t) ~[rad]
\end{equation}

y para la velocidad angular

\begin{equation}
  \omega(t) = - \omega_0\theta_0 sin(\omega_0t) ~[rad/s]~.
\end{equation}

\section{Ãngulo, Velocidad Angular y PerÃ­odo}

Una vez obtenidas las ecuaciones diferenciales que rigen el estado del pÃ©ndulo en funciÃ³n del tiempo, podemos resolverlas para encontrar $\theta(t)$, $\omega(t)$ y $T(t)$ empleando la rutina \mintinline{python}{odeint} tal y como se muestra en el CÃ³digo \ref{code:odeint}. A dicha rutina le proporcionaremos la funciÃ³n con las derivadas \mintinline{python}{pendulum} (mostrada en el CÃ³digo \ref{code:derivs}), las condiciones iniciales
\mintinline{python}{z_0_}, los pasos de tiempo \mintinline{python}{t_values_} y los parÃ¡metros necesarios para la integraciÃ³n \mintinline{python}{args=([G, args.l],)} (la constante gravitatoria y la longitud del pÃ©ndulo.

Posteriormente, del resultado \mintinline{python}{z_} extraeremos los valores de $\theta(t)$ en \mintinline{python}{z_[:,0]}, los de $\omega(t)$ en \mintinline{python}{z_[:,1]} y calcularemos los valores para la tensiÃ³n empleando los valores anteriores.

\medskip

\begin{code}
  \begin{minted}{python}
w_0_ = 0.0
theta_0_ = np.radians(theta_0)
t_values_ = np.linspace(args.t0,
            args.tf,
            int((args.tf - args.t0) / args.dt))
z_0_ = [theta_0_, w_0_]
z_ = odeint(pendulum, z_0_, t_values_,
            args=([G, args.l], ))

thetas_ = z_[:,0]
omegas_ = z_[:,1]
tension_ = args.m * G * np.cos(z_[:,0])
  \end{minted}
  \caption{ParÃ¡metros de integraciÃ³n, llamada a rutina \mintinline{python}{odeint} y extracciÃ³n de valores de $\theta(t)$, $\omega(t)$ y $T(t)$.}
  \label{code:odeint}
\end{code}

\begin{code}
  \begin{minted}{python}
def pendulum(y, t, params):
    phi, omega = y
    g, R = params
    derivs = [omega,
              -(g/R)*np.sin(phi)]
    return derivs
  \end{minted}
  \caption{CÃ³digo de derivadas para \mintinline{python}{odeint}.}
  \label{code:derivs}
\end{code}

Los resultados para diferentes Ã¡ngulos iniciales $\theta_0 = \{0.0, 5.0, 10.0, 20.0, 40.0\}~[rad]$, $l=5.0~[m]$ y $m=1.0~[kg]$ se muestran en las Figuras \ref{fig:theta}, \ref{fig:omega}, \ref{fig:tension} para $\theta(t)$, $\omega(t)$ y $T(t)$ respectivamente. En todos los casos $dt=0.001~[s]$, $t_0 = 0~[s]$ y $t_f = 10~[s]$.

\begin{figure}[!htb]
  \centering
  \includegraphics[width=\linewidth]{theta}
  \caption{EvoluciÃ³n del Ã¡ngulo $\theta$ con el tiempo para diversos Ã¡ngulos iniciales $\theta_0$.}
  \label{fig:theta}
\end{figure}

\begin{figure}[!htb]
  \centering
  \includegraphics[width=\linewidth]{omega}
  \caption{EvoluciÃ³n de la velocidad angular $\omega$ con el tiempo para diversos Ã¡ngulos iniciales $\theta_0$.}
  \label{fig:omega}
\end{figure}

\begin{figure}[!htb]
  \centering
  \includegraphics[width=\linewidth]{tension}
  \caption{EvoluciÃ³n de la tensiÃ³n $T$ con el tiempo para diversos Ã¡ngulos iniciales $\theta_0$.}
  \label{fig:tension}
\end{figure}

\section{Estudio del PerÃ­odo con la Amplitud}

En este primer conjunto de experimentos trataremos de determinar cÃ³mo depende el perÃ­odo de la oscilaciÃ³n del pÃ©ndulo $T$ con la amplitud inicial del mismo $\theta_0$. Para ello hemos solucionado las ecuaciones diferenciales expuestas anteriormente con la rutina \mintinline{python}{odeint} con el propÃ³sito de obtener la amplitud $\theta(t)$ en cada instante de tiempo y asÃ­ poder comprobar la evoluciÃ³n de la misma.

Para estos experimentos hemos elegido un tiempo inicial $t_0 = 0~[s]$, un tiempo final $t = 10~[s]$, un intervalo de tiempo $dt = 0.01~[s]$, masa del pÃ©ndulo $m = 1.0~[kg]$, longitud del mismo $l = 5.0~[m]$ y siete posibles valores para la amplitud inicial $\theta_0 = \{5, 10, 15, 30, 45, 60, 90\}~[deg]$.

\begin{figure}[!htb]
  \centering
  \includegraphics[width=\linewidth]{theta0}
  \caption{EvoluciÃ³n de la amplitud $\theta$ con el tiempo $t$ para diferentes amplitudes iniciales $\theta_0$. Valores calculados empleando la rutina de integraciÃ³n \mintinline{python}{odeint}.}
  \label{fig:theta0}
\end{figure}

La Figura \ref{fig:theta0} muestra las soluciones obtenidas a medida que incrementamos el valor del Ã¡ngulo inicial $\theta_0$. Como podemos observar, para Ã¡ngulos iniciales pequeÃ±os podemos realizar la aproximaciÃ³n $sin(\theta) \sim \theta$ y calcular su perÃ­odo como $T \sim 2\pi\sqrt{\frac{l}{g}}$. Para el caso que nos ocupa $T \sim 2\pi\sqrt{\frac{5}{9.8}} = 4.48~[s]$ y vemos que esta aproximaciÃ³n se cumple para los valores $\theta_0 = \{5, 10,
15\}$. A partir de $\theta_0 = 30$ se comienza a producir una desviaciÃ³n significativa respecto a ese perÃ­odo.

AsÃ­ pues, podemos concluir con que existe una relaciÃ³n entre la amplitud inicial y el perÃ­odo del pÃ©ndulo de manera que a medida que la amplitud aumenta tambiÃ©n lo hace el propio perÃ­odo $T\propto \theta_0$.

\section{ComparaciÃ³n con SoluciÃ³n AnalÃ­tica}

A continuaciÃ³n procederemos a comparar los resultados numÃ©ricos con las soluciones analÃ­ticas obtenidas empleando la aproximaciÃ³n de pequeÃ±as oscilaciones implementada en el CÃ³digo \ref{code:peqosc}. Las Figuras \ref{fig:numanal_5}, \ref{fig:numanal_10}, \ref{fig:numanal_20} y \ref{fig:numanal_40} muestran comparativas de los valores de $\theta$ para ambas soluciones con diferentes Ã¡ngulos iniciales $\theta_0$. Podemos comprobar como la aproximaciÃ³n difiere de los resultados numÃ©ricos a medida que el tiempo transcurre, siendo esta diferencia acentuada conforme incrementamos el Ã¡ngulo inicial $\theta_0$.

\medskip

\begin{code}
  \begin{minted}{python}
def small_angle_approx (theta0, w0, t):
  return theta0 * np.cos(w0 * t)
  \end{minted}
  \caption{CÃ³digo de aproximaciÃ³n de pequeÃ±as oscilaciones.}
  \label{code:peqosc}
\end{code}

\begin{figure}[!htb]
  \centering
  \includegraphics[width=\linewidth]{theta_5_diff}
  \caption{EvoluciÃ³n de la amplitud $\theta$ con el tiempo $t$ para amplitud inicial $\theta_0 = 5 [deg]$. Valores numÃ©ricos calculados empleando la rutina de integraciÃ³n \mintinline{python}{odeint} y analÃ­ticos empleando la aproximaciÃ³n de pequeÃ±as oscilaciones.}
  \label{fig:numanal_5}
\end{figure}
\begin{figure}[!htb]
  \centering
  \includegraphics[width=\linewidth]{theta_10_diff}
  \caption{EvoluciÃ³n de la amplitud $\theta$ con el tiempo $t$ para amplitud inicial $\theta_0 = 10 [deg]$. Valores numÃ©ricos calculados empleando la rutina de integraciÃ³n \mintinline{python}{odeint} y analÃ­ticos empleando la aproximaciÃ³n de pequeÃ±as oscilaciones.}
  \label{fig:numanal_10}
\end{figure}
\begin{figure}[!htb]
  \centering
  \includegraphics[width=\linewidth]{theta_20_diff}
  \caption{EvoluciÃ³n de la amplitud $\theta$ con el tiempo $t$ para amplitud inicial $\theta_0 = 20 [deg]$. Valores numÃ©ricos calculados empleando la rutina de integraciÃ³n \mintinline{python}{odeint} y analÃ­ticos empleando la aproximaciÃ³n de pequeÃ±as oscilaciones.}
  \label{fig:numanal_20}
\end{figure}
\begin{figure}[!htb]
  \centering
  \includegraphics[width=\linewidth]{theta_40_diff}
  \caption{EvoluciÃ³n de la amplitud $\theta$ con el tiempo $t$ para amplitud inicial $\theta_0 = 40 [deg]$. Valores numÃ©ricos calculados empleando la rutina de integraciÃ³n \mintinline{python}{odeint} y analÃ­ticos empleando la aproximaciÃ³n de pequeÃ±as oscilaciones.}
  \label{fig:numanal_40}
\end{figure}

La Tabla \ref{table:tiempodiff} muestra el tiempo que transcurre para cada uno de dichos experimentos mostrados en las grÃ¡ficas hasta que el resultado analÃ­tico $\theta_T(t)$ y el numÃ©rico $\theta(t)$ difieren en mÃ¡s de un umbral determinado ($1\%$), es decir $\left|\displaystyle\frac{\theta(t) - \theta_T(t)}{\theta_T(t)}\right|>0.01$.

Esta diferencia se puede apreciar tambiÃ©n en otra vista proporcionada por la Figura \ref{fig:diff}, la cual muestra la diferencia angular $\theta$ entre ambas soluciones a medida que transcurre el tiempo.

\begin{table}[!htb]
  \centering
  \begin{tabular}{c|cccc}
    & $\theta_0 = 5$ & $\theta_0 = 10$ & $\theta_0 = 20$ & $\theta_0 = 40$\\
    \hline
    Tiempo $[s]$ & $1.08$ & $0.94$ & $0.64$ & $0.35$\\
    \hline
  \end{tabular}
  \caption{Tiempo transcurrido hasta que la soluciÃ³n analÃ­tica y la numÃ©rica difieren en mÃ¡s de un $1\%$ para diferentes valores de Ã¡ngulo inicial $\theta_0 = \{5, 10, 20, 40\} [deg]$.}
  \label{table:tiempodiff}
\end{table}

\begin{figure}[!htb]
  \centering
  \includegraphics[width=\linewidth]{theta_diff}
  \caption{EvoluciÃ³n de la diferencia angular $\theta$ entre las soluciones analÃ­tica y numÃ©rica a lo largo del tiempo para diferentes valores de Ã¡ngulos iniciales.}
  \label{fig:diff}
\end{figure}

Por Ãºltimo, la Figura \ref{fig:tensiones_diff} muestra una comparativa entre la evoluciÃ³n de la tensiÃ³n para los experimentos anteriores, tanto para los casos numÃ©ricos como analÃ­ticos. Como se puede comprobar, existe una pequeÃ±a discrepancia entre ambas (la cual es causada a su vez por la diferencia entre las posiciones $\theta$ obtenidas ya que la propia tensiÃ³n es dependiente del Ã¡ngulo del pÃ©ndulo $T(\theta(t))$).

\begin{figure}[!htb]
  \centering
  \includegraphics[width=0.49\linewidth]{tension_diff}
  \includegraphics[width=0.49\linewidth]{tension_diff_approx}
  \caption{EvoluciÃ³n de la tensiÃ³n $T$ a lo largo del tiempo para diversos valores iniciales del Ã¡ngulo $\theta_0 = \{5.0, 10.0, 20.0, 40.0\}$ tanto para la soluciÃ³n numÃ©rica (izquierda) como analÃ­tica (derecha).}
  \label{fig:tensiones_diff}
\end{figure}

\section{IntroducciÃ³n de Rozamiento}

\begin{figure}[!htb]
  \centering
  \includegraphics[width=\linewidth]{alpha}
  \caption{EvoluciÃ³n de la amplitud $\theta$ con el tiempo $t$ para diferentes valores del tÃ©rmino de rozamiento $\alpha$ con amplitud inicial $\theta_0=90~[deg]$. Valores calculados empleando la rutina de integraciÃ³n \mintinline{python}{odeint}.}
  \label{fig:alpha}
\end{figure}

\section{ConclusiÃ³n}

% Can use something like this to put references on a page
% by themselves when using endfloat and the captionsoff option.
\ifCLASSOPTIONcaptionsoff
  \newpage
\fi

% trigger a \newpage just before the given reference
% number - used to balance the columns on the last page
% adjust value as needed - may need to be readjusted if
% the document is modified later
%\IEEEtriggeratref{8}
% The "triggered" command can be changed if desired:
%\IEEEtriggercmd{\enlargethispage{-5in}}

% references section

% can use a bibliography generated by BibTeX as a .bbl file
% BibTeX documentation can be easily obtained at:
% http://mirror.ctan.org/biblio/bibtex/contrib/doc/
% The IEEEtran BibTeX style support page is at:
% http://www.michaelshell.org/tex/ieeetran/bibtex/
%\bibliographystyle{IEEEtran}
% argument is your BibTeX string definitions and bibliography database(s)
%\bibliography{IEEEabrv,../bib/paper}
%
% <OR> manually copy in the resultant .bbl file
% set second argument of \begin to the number of references
% (used to reserve space for the reference number labels box)
\begin{thebibliography}{1}

\bibitem{IEEEhowto:kopka}
H.~Kopka and P.~W. Daly, \emph{A Guide to \LaTeX}, 3rd~ed.\hskip 1em plus
  0.5em minus 0.4em\relax Harlow, England: Addison-Wesley, 1999.

\end{thebibliography}

\end{document}

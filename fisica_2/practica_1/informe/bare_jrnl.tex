\documentclass[journal]{IEEEtran}
%
% If IEEEtran.cls has not been installed into the LaTeX system files,
% manually specify the path to it like:
% \documentclass[journal]{../sty/IEEEtran}





% Some very useful LaTeX packages include:
% (uncomment the ones you want to load)
\usepackage[spanish]{babel}
\usepackage[utf8]{inputenc}
\usepackage{url}
\usepackage{minted}
\setminted{fontsize=\small,baselinestretch=1}
\usepackage{listings}
\usepackage{subcaption}
\renewcommand\listingscaption{CÃ³digo}
\newenvironment{code}{\captionsetup{type=listing}}{\par\addvspace{\baselineskip}}
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{scopes}
\usetikzlibrary{babel}
\usepackage{pgfplots}
\usepackage{amsmath}

% *** MISC UTILITY PACKAGES ***
%
%\usepackage{ifpdf}
% Heiko Oberdiek's ifpdf.sty is very useful if you need conditional
% compilation based on whether the output is pdf or dvi.
% usage:
% \ifpdf
%   % pdf code
% \else
%   % dvi code
% \fi
% The latest version of ifpdf.sty can be obtained from:
% http://www.ctan.org/pkg/ifpdf
% Also, note that IEEEtran.cls V1.7 and later provides a builtin
% \ifCLASSINFOpdf conditional that works the same way.
% When switching from latex to pdflatex and vice-versa, the compiler may
% have to be run twice to clear warning/error messages.






% *** CITATION PACKAGES ***
%
%\usepackage{cite}
% cite.sty was written by Donald Arseneau
% V1.6 and later of IEEEtran pre-defines the format of the cite.sty package
% \cite{} output to follow that of the IEEE. Loading the cite package will
% result in citation numbers being automatically sorted and properly
% "compressed/ranged". e.g., [1], [9], [2], [7], [5], [6] without using
% cite.sty will become [1], [2], [5]--[7], [9] using cite.sty. cite.sty's
% \cite will automatically add leading space, if needed. Use cite.sty's
% noadjust option (cite.sty V3.8 and later) if you want to turn this off
% such as if a citation ever needs to be enclosed in parenthesis.
% cite.sty is already installed on most LaTeX systems. Be sure and use
% version 5.0 (2009-03-20) and later if using hyperref.sty.
% The latest version can be obtained at:
% http://www.ctan.org/pkg/cite
% The documentation is contained in the cite.sty file itself.






% *** GRAPHICS RELATED PACKAGES ***
%
\ifCLASSINFOpdf
  % \usepackage[pdftex]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../pdf/}{../jpeg/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.pdf,.jpeg,.png}
\else
  % or other class option (dvipsone, dvipdf, if not using dvips). graphicx
  % will default to the driver specified in the system graphics.cfg if no
  % driver is specified.
  % \usepackage[dvips]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../eps/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.eps}
\fi
% graphicx was written by David Carlisle and Sebastian Rahtz. It is
% required if you want graphics, photos, etc. graphicx.sty is already
% installed on most LaTeX systems. The latest version and documentation
% can be obtained at: 
% http://www.ctan.org/pkg/graphicx
% Another good source of documentation is "Using Imported Graphics in
% LaTeX2e" by Keith Reckdahl which can be found at:
% http://www.ctan.org/pkg/epslatex
%
% latex, and pdflatex in dvi mode, support graphics in encapsulated
% postscript (.eps) format. pdflatex in pdf mode supports graphics
% in .pdf, .jpeg, .png and .mps (metapost) formats. Users should ensure
% that all non-photo figures use a vector format (.eps, .pdf, .mps) and
% not a bitmapped formats (.jpeg, .png). The IEEE frowns on bitmapped formats
% which can result in "jaggedy"/blurry rendering of lines and letters as
% well as large increases in file sizes.
%
% You can find documentation about the pdfTeX application at:
% http://www.tug.org/applications/pdftex





% *** MATH PACKAGES ***
%
%\usepackage{amsmath}
% A popular package from the American Mathematical Society that provides
% many useful and powerful commands for dealing with mathematics.
%
% Note that the amsmath package sets \interdisplaylinepenalty to 10000
% thus preventing page breaks from occurring within multiline equations. Use:
%\interdisplaylinepenalty=2500
% after loading amsmath to restore such page breaks as IEEEtran.cls normally
% does. amsmath.sty is already installed on most LaTeX systems. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/pkg/amsmath





% *** SPECIALIZED LIST PACKAGES ***
%
%\usepackage{algorithmic}
% algorithmic.sty was written by Peter Williams and Rogerio Brito.
% This package provides an algorithmic environment fo describing algorithms.
% You can use the algorithmic environment in-text or within a figure
% environment to provide for a floating algorithm. Do NOT use the algorithm
% floating environment provided by algorithm.sty (by the same authors) or
% algorithm2e.sty (by Christophe Fiorio) as the IEEE does not use dedicated
% algorithm float types and packages that provide these will not provide
% correct IEEE style captions. The latest version and documentation of
% algorithmic.sty can be obtained at:
% http://www.ctan.org/pkg/algorithms
% Also of interest may be the (relatively newer and more customizable)
% algorithmicx.sty package by Szasz Janos:
% http://www.ctan.org/pkg/algorithmicx




% *** ALIGNMENT PACKAGES ***
%
%\usepackage{array}
% Frank Mittelbach's and David Carlisle's array.sty patches and improves
% the standard LaTeX2e array and tabular environments to provide better
% appearance and additional user controls. As the default LaTeX2e table
% generation code is lacking to the point of almost being broken with
% respect to the quality of the end results, all users are strongly
% advised to use an enhanced (at the very least that provided by array.sty)
% set of table tools. array.sty is already installed on most systems. The
% latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/array


% IEEEtran contains the IEEEeqnarray family of commands that can be used to
% generate multiline equations as well as matrices, tables, etc., of high
% quality.




% *** SUBFIGURE PACKAGES ***
%\ifCLASSOPTIONcompsoc
%  \usepackage[caption=false,font=normalsize,labelfont=sf,textfont=sf]{subfig}
%\else
%  \usepackage[caption=false,font=footnotesize]{subfig}
%\fi
% subfig.sty, written by Steven Douglas Cochran, is the modern replacement
% for subfigure.sty, the latter of which is no longer maintained and is
% incompatible with some LaTeX packages including fixltx2e. However,
% subfig.sty requires and automatically loads Axel Sommerfeldt's caption.sty
% which will override IEEEtran.cls' handling of captions and this will result
% in non-IEEE style figure/table captions. To prevent this problem, be sure
% and invoke subfig.sty's "caption=false" package option (available since
% subfig.sty version 1.3, 2005/06/28) as this is will preserve IEEEtran.cls
% handling of captions.
% Note that the Computer Society format requires a larger sans serif font
% than the serif footnote size font used in traditional IEEE formatting
% and thus the need to invoke different subfig.sty package options depending
% on whether compsoc mode has been enabled.
%
% The latest version and documentation of subfig.sty can be obtained at:
% http://www.ctan.org/pkg/subfig




% *** FLOAT PACKAGES ***
%
%\usepackage{fixltx2e}
% fixltx2e, the successor to the earlier fix2col.sty, was written by
% Frank Mittelbach and David Carlisle. This package corrects a few problems
% in the LaTeX2e kernel, the most notable of which is that in current
% LaTeX2e releases, the ordering of single and double column floats is not
% guaranteed to be preserved. Thus, an unpatched LaTeX2e can allow a
% single column figure to be placed prior to an earlier double column
% figure.
% Be aware that LaTeX2e kernels dated 2015 and later have fixltx2e.sty's
% corrections already built into the system in which case a warning will
% be issued if an attempt is made to load fixltx2e.sty as it is no longer
% needed.
% The latest version and documentation can be found at:
% http://www.ctan.org/pkg/fixltx2e


%\usepackage{stfloats}
% stfloats.sty was written by Sigitas Tolusis. This package gives LaTeX2e
% the ability to do double column floats at the bottom of the page as well
% as the top. (e.g., "\begin{figure*}[!b]" is not normally possible in
% LaTeX2e). It also provides a command:
%\fnbelowfloat
% to enable the placement of footnotes below bottom floats (the standard
% LaTeX2e kernel puts them above bottom floats). This is an invasive package
% which rewrites many portions of the LaTeX2e float routines. It may not work
% with other packages that modify the LaTeX2e float routines. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/pkg/stfloats
% Do not use the stfloats baselinefloat ability as the IEEE does not allow
% \baselineskip to stretch. Authors submitting work to the IEEE should note
% that the IEEE rarely uses double column equations and that authors should try
% to avoid such use. Do not be tempted to use the cuted.sty or midfloat.sty
% packages (also by Sigitas Tolusis) as the IEEE does not format its papers in
% such ways.
% Do not attempt to use stfloats with fixltx2e as they are incompatible.
% Instead, use Morten Hogholm'a dblfloatfix which combines the features
% of both fixltx2e and stfloats:
%
% \usepackage{dblfloatfix}
% The latest version can be found at:
% http://www.ctan.org/pkg/dblfloatfix




%\ifCLASSOPTIONcaptionsoff
%  \usepackage[nomarkers]{endfloat}
% \let\MYoriglatexcaption\caption
% \renewcommand{\caption}[2][\relax]{\MYoriglatexcaption[#2]{#2}}
%\fi
% endfloat.sty was written by James Darrell McCauley, Jeff Goldberg and 
% Axel Sommerfeldt. This package may be useful when used in conjunction with 
% IEEEtran.cls'  captionsoff option. Some IEEE journals/societies require that
% submissions have lists of figures/tables at the end of the paper and that
% figures/tables without any captions are placed on a page by themselves at
% the end of the document. If needed, the draftcls IEEEtran class option or
% \CLASSINPUTbaselinestretch interface can be used to increase the line
% spacing as well. Be sure and use the nomarkers option of endfloat to
% prevent endfloat from "marking" where the figures would have been placed
% in the text. The two hack lines of code above are a slight modification of
% that suggested by in the endfloat docs (section 8.4.1) to ensure that
% the full captions always appear in the list of figures/tables - even if
% the user used the short optional argument of \caption[]{}.
% IEEE papers do not typically make use of \caption[]'s optional argument,
% so this should not be an issue. A similar trick can be used to disable
% captions of packages such as subfig.sty that lack options to turn off
% the subcaptions:
% For subfig.sty:
% \let\MYorigsubfloat\subfloat
% \renewcommand{\subfloat}[2][\relax]{\MYorigsubfloat[]{#2}}
% However, the above trick will not work if both optional arguments of
% the \subfloat command are used. Furthermore, there needs to be a
% description of each subfigure *somewhere* and endfloat does not add
% subfigure captions to its list of figures. Thus, the best approach is to
% avoid the use of subfigure captions (many IEEE journals avoid them anyway)
% and instead reference/explain all the subfigures within the main caption.
% The latest version of endfloat.sty and its documentation can obtained at:
% http://www.ctan.org/pkg/endfloat
%
% The IEEEtran \ifCLASSOPTIONcaptionsoff conditional can also be used
% later in the document, say, to conditionally put the References on a 
% page by themselves.

% *** PDF, URL AND HYPERLINK PACKAGES ***
%
%\usepackage{url}
% url.sty was written by Donald Arseneau. It provides better support for
% handling and breaking URLs. url.sty is already installed on most LaTeX
% systems. The latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/url
% Basically, \url{my_url_here}.


% *** Do not adjust lengths that control margins, column widths, etc. ***
% *** Do not use packages that alter fonts (such as pslatex).         ***
% There should be no need to do such things with IEEEtran.cls V1.6 and later.
% (Unless specifically asked to do so by the journal or conference you plan
% to submit to, of course. )


% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}


\begin{document}
%
% paper title
% Titles are generally capitalized except for words such as a, an, and, as,
% at, but, by, for, in, nor, of, on, or, the, to and up, which are usually
% not capitalized unless they are the first or last word of the title.
% Linebreaks \\ can be used within to get better formatting as desired.
% Do not put math or special symbols in the title.
\title{Movimiento de Cargas en Campos ElectromagnÃ©ticos}
%
%
% author names and IEEE memberships
% note positions of commas and nonbreaking spaces ( ~ ) LaTeX will not break
% a structure at a ~ so this keeps an author's name from being broken across
% two lines.
% use \thanks{} to gain access to the first footnote area
% a separate \thanks must be used for each paragraph as LaTeX2e's \thanks
% was not built to handle multiple paragraphs
%

\author{Alberto GarcÃ­a GarcÃ­a\\ (48718198-N)\\ \texttt{agg180@alu.ua.es} % <-this % stops a space
\thanks{}%
}


% The paper headers
\markboth{FÃ­sica II -- Grado en FÃ­sica -- 2018-2019}%
{}
% The only time the second header will appear is for the odd numbered pages
% after the title page when using the twoside option.
% 
% *** Note that you probably will NOT want to include the author's ***
% *** name in the headers of peer review papers.                   ***
% You can use \ifCLASSOPTIONpeerreview for conditional compilation here if
% you desire.


% make the title area
\maketitle

% As a general rule, do not put math, special symbols or citations
% in the abstract or keywords.
\begin{abstract}
En esta primera prÃ¡ctica de la asignatura FÃ­sica II del Grado en FÃ­sica (curso acadÃ©mico 2018-2019) estudiaremos el movimiento de cargas en campos electromagnÃ©ticos. Para ello consideraremos diferentes partÃ­culas (iones de hidrÃ³geno, electrones y protones) en diversos instrumentos tÃ­picos y estudiados en la parte teÃ³rica de la asignatura: el espectrÃ³metro de masas, el selector de velocidades y el ciclotrÃ³n. Para cada caso desarrollaremos las ecuaciones analÃ­ticas que nos permitan resolver el movimiento de dichas partÃ­culas de forma teÃ³rica para posteriormente ejecutar los programas de simulaciÃ³n proporcionados con el objetivo de contrastar los resultados teÃ³ricos con los generados numÃ©ricamente. AdemÃ¡s, exploraremos el efecto de variar ciertos parÃ¡metros en cada uno de los instrumentos tambiÃ©n tanto de forma teÃ³rica como simulada.

El cÃ³digo Python que implementa esta prÃ¡ctica asÃ­ las modificaciones realizadas a sus rutinas de visualizaciÃ³n y las fuentes \LaTeX de este informe se encuentran disponibles online en el repositorio \url{https://github.com/Blitzman/physics/tree/master/fisica_2/practica_1}.
\end{abstract}


% For peer review papers, you can put extra information on the cover
% page as needed:
% \ifCLASSOPTIONpeerreview
% \begin{center} \bfseries EDICS Category: 3-BBND \end{center}
% \fi
%
% For peerreview papers, this IEEEtran command inserts a page break and
% creates the second title. It will be ignored for other modes.
\IEEEpeerreviewmaketitle

\section{IntroducciÃ³n}

\IEEEPARstart{U}{na} partÃ­cula cargada en el seno de un campo electromagnÃ©tico se ve sometida a una fuerza que provoca un movimiento de la misma. En esta primera prÃ¡ctica de la asignatura estudiaremos el movimiento de partÃ­culas cargadas en campos electromagnÃ©ticos generados por los siguientes instrumentos: el espectrÃ³metro de masas, el selector de velocidad y por Ãºltimo el ciclotrÃ³n.

Para ello, analizaremos en primer lugar de forma teÃ³rica todos los instrumentos mencionados y obtendremos las ecuaciones del movimiento y los resultados del mismo de forma analÃ­tica. Posteriormente, resolveremos numÃ©ricamente las ecuaciones de movimiento utilizando algoritmos de simulaciÃ³n e integraciÃ³n numÃ©rica en Python. En cada caso, compararemos la soluciÃ³n obtenida de forma numÃ©rica con el resultado analÃ­tico y discutiremos los resultados.

El informe se organiza de la siguiente manera. En primer lugar, la SecciÃ³n \ref{sec:espectrometro} presenta los cÃ¡lculos y la simulaciÃ³n del movimiento de isÃ³topos de hidrÃ³geno en un espectrÃ³metro de masas. Seguidamente, la SecciÃ³n \ref{sec:selector} describe el comportamiento de esos mismos iones en este caso en un selector de velocidades. A continuaciÃ³n, la SecciÃ³n \ref{sec:frecuencia} se dedica al estudio de la variaciÃ³n de la frecuencia de ciclotrÃ³n con la velocidad de la partÃ­cula (un electrÃ³n) a medida que esta se aproxima a cotas relativistas. La SecciÃ³n \ref{sec:ciclotron} estudia la trayectoria de un protÃ³n al ser acelerado en un ciclotrÃ³n. Por Ãºltimo, la SecciÃ³n \ref{sec:conclusion} presenta las conclusiones sobre este trabajo.

\newpage

\section{EspectrÃ³metro de Masas}
\label{sec:espectrometro}

En este primer apartado de la prÃ¡ctica estudiaremos el movimiento de una carga en un espectrÃ³metro de masas. En dicho instrumento (ver Figura \ref{fig:espetrometro}), iones procedentes de una fuente e inicialmente en reposo y los acelera mediante un campo elÃ©ctrico, una vez abandonan dicho campo elÃ©ctrico entran en una regiÃ³n en la que existe un campo magnÃ©tico perpendicular a su velocidad que los desvÃ­a hasta que colisionan contra una superficie. Los iones seguirÃ¡n trayectorias con radios de curvatura diferentes segÃºn su relaciÃ³n carga/masa y por ello tendrÃ¡n puntos de incidencia distintos lo cual permite diferenciar unos de otros.

\begin{figure}[!htb]
    \includegraphics[width=\linewidth]{espectrometro.png}
    \caption{RepresentaciÃ³n esquemÃ¡tica del espectrÃ³metro de masas con el campo elÃ©ctrico $E$, el campo magnÃ©tico $B$, la distancia entre las placas $LE$ y la distancia de simulaciÃ³n considerada $LB$. En azul se muestra la trayectoria seguida por un ion cualquiera.}
    \label{fig:espetrometro}
\end{figure}

Para resolver este problema necesitamos encontrar por lo tanto la posiciÃ³n $x$ a la que llegarÃ¡n los tres iones propuestos. Para el cÃ¡lculo tanto analÃ­tico como simulado emplearemos los siguientes datos de entrada:

\begin{itemize}
    \item La carga $q = 1.6\cdot10^{-19}~[C]$ y las masa $m_1 = 1.66\cdot10^{-27}~[kg], m_2 = 3.32\cdot10^{-27}~[kg]$ y $m_3 = 4.98\cdot10^{-27}~[kg]$ de los tres iones $^1H^+$, $^2H^+$ y $^3H+$.
    \item La diferencia de potencial entre las placas $V = 15~[V]$.
    \item La distancia entre las placas $LE = 1\cdot 10^{-3}~[m]$.
    \item El campo magnÃ©tico $B = 1\cdot10^{-2}~[T]$.
\end{itemize}

\subsection{CÃ¡lculos AnalÃ­ticos}

En primer lugar, calcularemos el campo elÃ©ctrico $E~[V\cdot m^{-1}]$ entre las placas sabiendo que existe entre ellas una diferencia de potencial $\Delta V~[V]$ y una separaciÃ³n de $LE~[m]$

\begin{equation}
E = \displaystyle\frac{\Delta V}{LE}~[V\cdot m^{-1}]~,
\end{equation}

conociendo el campo elÃ©ctrico podemos determinar la aceleraciÃ³n $a~[m\cdot s^{-2}]$ que sufren los iones debido a la fuerza elÃ©ctrica $F_e~[N]$ que se les aplica

\begin{equation}
F_e = ma \Rightarrow qE = ma \Rightarrow a = \displaystyle\frac{qE}{m}~[m\cdot s^{-2}]~.
\end{equation}

Si queremos conocer la velocidad final $v~[m\cdot s^{-1}]$ con la que abandonan los iones el campo elÃ©ctrico basta con plantear las ecuaciones de movimiento para determinar en primer lugar el tiempo que tarda el ion en dicho tramo y posteriormente emplearlo para determinar la velocidad final teniendo en cuenta la aceleraciÃ³n uniforme a la que se somete el ion en la regiÃ³n

\begin{equation}
x = x_0 + v_0t + \displaystyle\frac{1}{2}at^2 \Rightarrow LE = \displaystyle\frac{1}{2}at^2 \Rightarrow t = \sqrt{\displaystyle\frac{2LE}{a}}~[s]~,
\end{equation}

\begin{equation}
v = v_0 + at \Rightarrow v = a\sqrt{\displaystyle\frac{2LE}{a}} \Rightarrow v = \sqrt{2aLE}~[m\cdot s^{-1}]~.
\end{equation}

Una vez el ion abandona el campo elÃ©ctrico, se ve sometido a una aceleraciÃ³n causada por el campo magnÃ©tico la cual hace que describa un movimiento circular cuyo radio podemos determinar

\begin{equation}
F_m = ma_c \Rightarrow qvB = m \displaystyle\frac{v^2}{r} \Rightarrow r = \displaystyle\frac{mv}{qB}~[m],
\end{equation}

y por lo tanto, el tiempo que tardan los iones en recorrer el semicÃ­rculo esos

\begin{equation}
t = \displaystyle\frac{v}{a} + \pi \displaystyle\frac{r}{v} = \displaystyle\frac{v}{qB} + \pi \displaystyle\frac{r}{v}~[s].
\end{equation}

\subsubsection{IÃ³n $^1H^+$}

El primer iÃ³n tiene una carga $q_1 = 1.6\cdot 10^{-19}$ y una masa $m_1 = 1\cdot 10^{-3} / 6.022\cdot 10^{23} = 1.66\cdot 10^{-27}~[kg]$. El campo elÃ©ctrico es fijo y comÃºn para todos los iones $E = \Delta V / LE = 15 / 10\cdot 10^{-2} = 1.5\cdot 10^2~[V\cdot m^{-1}]$.

La aceleraciÃ³n de este iÃ³n es

\begin{equation}
a_1 = \displaystyle\frac{q_1E}{m_1} = \displaystyle\frac{1.6\cdot 10^{-19}\cdot 1.5\cdot 10^{2}}{1.66\cdot 10^{-27}} = 1.44 \cdot 10^{10}~[m\cdot s^{-2}]~,
\end{equation}

y por lo tanto la velocidad al salir de la regiÃ³n de campo elÃ©ctrico serÃ¡

\begin{equation}
    v_1 = \sqrt{2a_1LE} = \sqrt{2\cdot 1.44\cdot 10^{10} \cdot 10^{-1}} = 5.37 \cdot 10^4~[m\cdot s^{-1}]~.
\end{equation}

Conociendo la velocidad podemos calcular tanto el radio de la curva que describirÃ¡ en el seno de la regiÃ³n de campo magnÃ©tico asÃ­ como el tiempo que tardarÃ¡ en describir el semicÃ­rculo

\begin{equation}
r_1 = \displaystyle\frac{m_1v_1}{q_1B} = \displaystyle\frac{1.66\cdot 10^{-27} \cdot 5.37\cdot 10^4}{1.6\cdot 10^{-19}\cdot 1 \cdot 10^{-2}} = 5.57 \cdot 10^{-2}~[m].
\end{equation}

\begin{equation}
t_1 = \displaystyle\frac{v_1}{a_1} + \pi \displaystyle\frac{r_1}{v_1} = \displaystyle\frac{5.37 \cdot 10^4}{1.44 \cdot 10^{10}} + \pi \displaystyle\frac{5.57 \cdot 10^{-2}}{5.37 \cdot 10^4} = 6.99 \cdot 10^{-6}~[s]~.
\end{equation}

La posiciÃ³n en el eje $x$ en la que se producirÃ¡ el impacto es simplemente el diÃ¡metro de la trayectoria circular $x_1 = 2\cdot5.57 \cdot 10^{-2} = 1.11 \cdot 10^-1~[m]$.

\subsubsection{IÃ³n $^2H^+$}

El segundo iÃ³n tiene una carga $q_2 = 1.6\cdot 10^{-19}$ y una masa $m_2 = 2\cdot 10^{-3} / 6.022\cdot 10^{23} = 3.32\cdot 10^{-27}~[kg]$. La aceleraciÃ³n de este iÃ³n es

\begin{equation}
a_2 = \displaystyle\frac{qE}{m} = \displaystyle\frac{1.6\cdot 10^{-19}\cdot 1.5\cdot 10^{2}}{3.32\cdot 10^{-27}} = 7.23 \cdot 10^{9}~[m\cdot s^{-2}]~,
\end{equation}

y por lo tanto la velocidad al salir de la regiÃ³n de campo elÃ©ctrico serÃ¡

\begin{equation}
v_2 = \sqrt{2a_2LE} = \sqrt{2\cdot 7.23 \cdot 10^{9} \cdot 10^{-1}} = 3.80 \cdot 10^4~[m\cdot s^{-1}]~.
\end{equation}

Conociendo la velocidad podemos calcular tanto el radio de la curva que describirÃ¡ en el seno de la regiÃ³n de campo magnÃ©tico asÃ­ como el tiempo que tardarÃ¡ en describir el semicÃ­rculo

\begin{equation}
r_2 = \displaystyle\frac{mv}{qB} = \displaystyle\frac{3.32\cdot 10^{-27} \cdot 3.80\cdot 10^4}{1.6\cdot 10^{-19}\cdot 1 \cdot 10^{-2}} = 7.90\cdot 10^{-2}~[m].
\end{equation}

\begin{equation}
t_2 = \displaystyle\frac{v}{a} + \pi \displaystyle\frac{r}{v} = \displaystyle\frac{3.80 \cdot 10^4}{7.23 \cdot 10^{9}} + \pi \displaystyle\frac{7.90 \cdot 10^{-2}}{3.80 \cdot 10^4} = 1.18 \cdot 10^{-5}~[s]~.
\end{equation}

La posiciÃ³n en el eje $x$ en la que se producirÃ¡ el impacto es simplemente el diÃ¡metro de la trayectoria circular $x_2 = 2\cdot7.90 \cdot 10^{-2} = 1.58 \cdot 10^-1~[m]$.

\subsubsection{IÃ³n $^3H^+$}

El tercer iÃ³n tiene una carga $q_3 = 1.6\cdot 10^{-19}$ y una masa $m_3 = 3\cdot 10^{-3} / 6.022\cdot 10^{23} = 4.98\cdot 10^{-27}~[kg]$. La aceleraciÃ³n de este iÃ³n es

\begin{equation}
a_3 = \displaystyle\frac{qE}{m} = \displaystyle\frac{1.6\cdot 10^{-19}\cdot 1.5\cdot 10^{2}}{4.98\cdot 10^{-27}} = 4.81 \cdot 10^{9}~[m\cdot s^{-2}]~,
\end{equation}

y por lo tanto la velocidad al salir de la regiÃ³n de campo elÃ©ctrico serÃ¡

\begin{equation}
v_3 = \sqrt{2a_3LE} = \sqrt{2\cdot 4.81 \cdot 10^{9} \cdot 10^{-1}} = 3.10 \cdot 10^4~[m\cdot s^{-1}]~.
\end{equation}

Conociendo la velocidad podemos calcular tanto el radio de la curva que describirÃ¡ en el seno de la regiÃ³n de campo magnÃ©tico asÃ­ como el tiempo que tardarÃ¡ en describir el semicÃ­rculo

\begin{equation}
r_3 = \displaystyle\frac{mv}{qB} = \displaystyle\frac{4.98\cdot 10^{-27} \cdot 3.10\cdot 10^4}{1.6\cdot 10^{-19}\cdot 1 \cdot 10^{-2}} = 9.64\cdot 10^{-2}~[m].
\end{equation}

\begin{equation}
t_3 = \displaystyle\frac{v}{a} + \pi \displaystyle\frac{r}{v} = \displaystyle\frac{3.10 \cdot 10^4}{4.81 \cdot 10^{9}} + \pi \displaystyle\frac{9.64 \cdot 10^{-2}}{3.10 \cdot 10^4} = 1.62 \cdot 10^{-5}~[s]~.
\end{equation}

La posiciÃ³n en el eje $x_3$ en la que se producirÃ¡ el impacto es simplemente el diÃ¡metro de la trayectoria circular $x_3 = 2\cdot9.64 \cdot 10^{-2} = 1.93 \cdot 10^{-2}~[m]$.

\subsection{SimulaciÃ³n}

Los valores arrojados por la simulaciÃ³n (ejecutada con los parÃ¡metros antes mencionados y mostrados en el CÃ³digo \ref{listing:datos_espectrometro}) son $x^s_1 = 1.11\cdot 10^{-1}~[m]$, $x^s_2 = 1.58\cdot 10^{-1}~[m]$, $x^s_3 = 1.93\cdot 10^{-1}~[m]$ tal y como se puede observar en la Figura \ref{fig:espectrometro_simulacion}. AsÃ­ pues, la simulaciÃ³n confirma nuestra soluciÃ³n analÃ­tica y viceversa puesto que los valores obtenidos en el cÃ¡lculo de la secciÃ³n anterior son tambiÃ©n $x_1 = 1.11\cdot 10^{-1}~[m]$, $x_2 = 1.58\cdot 10^{-1}~[m]$, $x_3 = 1.93\cdot 10^{-1}~[m]$.

\bigskip

\begin{code}
    \begin{minted}{python}
m=1.0e-3 / 6.022e23  #masa de la primer ion
q=1.6e-19  #carga del primer ion
m2=2.0e-3 / 6.022e23 #masa del segundo ion
q2=1.6e-19  #carga del segundo ion
m3=3.0e-3 / 6.022e23 #masa del tercer ion
q3=1.6e-19  #carga del tercer ion
Bf=1.0e-2 #Campo magnÃ©tico usado
LE=10.0e-2  #Distancia entre las placas
dV=15.0  #Diferencia de potencial
LB=0.25  #Distancia horizontal considerada
tf=18e-6  # tiempo de simulaciÃ³n considerado 
    \end{minted}
    \caption{Datos de simulaciÃ³n.}
    \label{listing:datos_espectrometro}
\end{code}

\begin{figure}[!htb]
    \includegraphics[width=\linewidth]{espectrometro_simulacion}
    \caption{GrÃ¡fica de simulaciÃ³n de espectrÃ³metro de masa para los iones de hidrÃ³geno $^1H^+$, $^2H^+$ y $^3H+$. El detalle muestra los puntos de impacto $x^s_1 = 1.11\cdot 10^{-1}~[m]$, $x^s_2 = 1.58\cdot 10^{-1}~[m]$, $x^s_3 = 1.93\cdot 10^{-1}~[m]$.}
    \label{fig:espectrometro_simulacion}
\end{figure}

\newpage

\section{Selector de Velocidades}
\label{sec:selector}

En el segundo apartado de la prÃ¡ctica estudiaremos el movimiento de uno de los iones ya mencionados en la secciÃ³n anterior pero esta vez en el seno de otro instrumento: el selector de velocidades. En este caso, los iones procedentes de una fuente entran con una velocidad inicial al selector, dentro del cual existe tanto un campo elÃ©ctrico (perpendicular a la direcciÃ³n de entrada) y un campo magnÃ©tico (perpendicular tanto al campo elÃ©ctrico como a la direcciÃ³n de entrada). SegÃºn el valor de los campos y la energÃ­a cinÃ©tica del ion, la partÃ­cula en el interior se desviarÃ¡ en mayor o menor medida o bien no se desviarÃ¡ y realizarÃ¡ un movimiento rectilÃ­neo consiguiendo salir del selector por una pequeÃ±a apertura en el extremo opuesto. De esta forma, eligiendo los valores adecuados para los campos se puede seleccionar aquellas partÃ­culas con una velocidad determinada. La Figura \ref{fig:selector} muestra un equema de dicho instrumento.

\begin{figure}[!htb]
    \includegraphics[width=\linewidth]{selector.png}
    \caption{RepresentaciÃ³n esquemÃ¡tica del selector de velocidades de longitud $L$ con un campo elÃ©ctrico $E$ y magnÃ©tico $B$ y una separaciÃ³n entre placas $2H$.}
    \label{fig:selector}
\end{figure}

Para resolver este problema fijaremos un campo elÃ©ctrico y variaremos el campo magnÃ©tico hasta conseguir de forma experimental que la partÃ­cula salga por la rendija. Para que esto ocurra, la fuerza magnÃ©tica debe compensar la fuerza elÃ©ctrica hasta cierto punto para que la partÃ­cula no sufra una desviaciÃ³n que le impida salir por la rendija. Para el cÃ¡lculo tanto analÃ­tico como simulado emplearemos los siguientes datos de entrada:

\begin{itemize}
    \item La carga de uno de los iones anteriores $q = 1.6\cdot10^{-19}~[C]$ y su masa $m_1 = 1.66\cdot10^{-27}~[kg]$ para $^1H^+$.
    \item La energÃ­a cinÃ©tica del ion al entrar en el selector $E_c = 30 [eV]$.
    \item La diferencia de potencial entre las placas $V = 25~[V]$.
    \item La distancia entre las placas horizonales $2H = 4\cdot 10^{-1}~[m]$.
    \item La longitud del selector $L = 2~[m]$.
    \item La apertura final del detector $2dy$ siendo $dy = 5\cdot10^{-2}H~[m]$.
\end{itemize}

\subsection{CÃ¡lculos AnalÃ­ticos}

Dado que la fuerza total que actÃºa sobre la partÃ­cula viene dada por la fuerza de Lorent

\begin{equation}
    F = q(E + v \times B)~[N],
\end{equation}

para conseguir que la partÃ­cula siga una trayectoria rectilÃ­nea y por lo tanto sea capaz de alcanzar la rendija es necesario que la fuerza ejercida por el campo elÃ©ctrico sea compensada por la fuerza realizada por el campo elÃ©ctrico

\begin{equation}
    F_e = F_m \Rightarrow qE = qvB,
\end{equation}

de lo cual deducimos que la velocidad del iÃ³n que serÃ¡ seleccionado (capaz de alcanzar la rendija sin desviarse significativamente) serÃ¡

\begin{equation}
    v = \displaystyle\frac{E}{B}~[m\cdot s].
\end{equation}

AsÃ­ pues, ajustando los valores de ambos campos podemos hacer que Ãºnicamente las partÃ­culas con una determinada velocidad de entrada $v$ sigan una trayectoria rectilÃ­nea. Aquellas con una velocidad menor se verÃ¡n mÃ¡s influenciadas por la fuerza elÃ©ctrica y por lo tanto se desviarÃ¡n hacia arriba mientras que aquellas con una velocidad mayor sufrirÃ¡n una fuerza magnÃ©tica mÃ¡s intensa y se desviarÃ¡n hacia abajo. Si esta desviaciÃ³n es demasiado pronunciada, no conseguirÃ¡n alcanzar la rendija.

Para el caso que nos ocupa, el iÃ³n $^1H^+$, sabemos que su masa es de $m = 1.66\cdot 10^{-27}~[kg]$ y su carga es $q = 1.6 \cdot 10^{-19}~[C]$. La energÃ­a cinÃ©tica de dicha partÃ­cula la hemos fijado en $30~[eV]$ ($30\cdot 1.6\cdot 10^{-19}~[J]$) por lo que a partir de la misma podemos obtener su velocidad

\begin{equation}
    E_c = \displaystyle\frac{1}{2}mv^2 \Rightarrow v = \sqrt{\displaystyle\frac{2E_c}{m}} = 7.6\cdot 10^4~[m\cdot s^{-1}]~.
\end{equation}

Dado que hemos fijado una diferencia de potencial de $V = 25~[V]$ y una distancia entre las placas horizontales de $2H = 4\cdot 10^{-1}~[m]$, podemos calcular el campo elÃ©ctrico $E$ como

\begin{equation}
    V = Ed \Rightarrow E = \displaystyle\frac{V}{2H} = \displaystyle\frac{25}{2\cdot 4\cdot 10^{-1}} = 6.25~[V\cdot m^{-1}]~.
\end{equation}

Por lo tanto, el campo magnÃ©tico que necesitaremos para compensar la fuerza elÃ©ctrica con el objetivo de seleccionar la velocidad $v$ dada es

\begin{equation}
    v = \displaystyle\frac{E}{B} \Rightarrow B = \displaystyle\frac{E}{v} = \displaystyle\frac{6.25}{7.6\cdot 10^4} = 8.21 \cdot 10^{-4}~[T]~.
\end{equation}

\subsection{SimulaciÃ³n}

Durante la simulaciÃ³n, hemos variado el campo magnÃ©tico sin conocer el valor analÃ­tico hasta conseguir que el iÃ³n atraviese la rendija utilizando los valores de energÃ­a cinÃ©tica y de campo elÃ©ctrico (diferencia de potencial y distancia entre las placas) seleccionados anteriormente (ver CÃ³digo \ref{listing:datos_selector}). Finalmente, llegamos a la conclusiÃ³n de que el valor analÃ­tico $B = 8.21\cdot 10^{-4}~[T]$ permite al iÃ³n alcanzar la rendija sin desviarse tal y como se muestra en la Figura \ref{fig:selector_simulacion}.

\newpage

\begin{code}
    \begin{minted}{python}
# Datos de entrada
# El programa calcula la trayectoria en un
# selector de velocidad de un ion con una
# dada velocidad, y la del mismo ion pero
# con una velocidad 10 % mayor y 10% menor

# Masa del ion
m=1.0e-3 / 6.022e23  
#Carga del ion
q=1.6e-19   
# 2*H es la distancia entre las placas horizontales
H=0.2
# Diferencia de potencial entre ambas placas  
dV=25     
E=dV/2./H   # Campo elÃ©ctrico uniforme
# Campo magnÃ©tico
B=8.21e-4  
# Distancia horizontal del selector
L=2.0  
# EnergÃ­a cinÃ©tica del ion que entra
Ec=30*1.6e-19  
#Velocidad del ion que entra al selector
vx0=np.sqrt(2*Ec/m)  
# 2*dy es el tamaÃ±o de la apertura
dy=0.05 * H 

#tiempo final de simulacion
tf=10.0           
    \end{minted}
    \caption{Datos de simulaciÃ³n de selector de velocidad.}
    \label{listing:datos_selector}
\end{code}

\begin{figure}[!htb]
    \includegraphics[width=\linewidth]{selector_simulacion}
    \caption{GrÃ¡fica de simulaciÃ³n de selector de velocidad con $v_0 = 7.6\cdot 10^4~[m\cdot s^{-1}]$, $E = 6.25~[V\cdot m^{-1}]$ y $B = 8.21\cdot 10^{-4}~[T]$ tal y como calculamos de forma analÃ­tica. Como podemos observar, el iÃ³n es capaz de alcanzar la rendija. La simulaciÃ³n tambiÃ©n muestra el resultado de utilizar un $90\%$ de la velocidad inicial (el campo elÃ©ctrico desvÃ­a el iÃ³n hacia arriba) y utilizar un $110\%$ de la misma (el campo magnÃ©tico desvÃ­a el iÃ³n hacia abajo).}
    \label{fig:selector_simulacion}
\end{figure}

\newpage

\section{Frecuencia de CiclotrÃ³n Relativista}
\label{sec:frecuencia}

En este apartado se pide estudiar el movimiento de partÃ­culas relativistas en campos
magnÃ©ticos, es decir, teniendo en cuenta el efecto que tiene la teorÃ­a de la relatividad
especial sobre el movimiento. En definitiva, deberemos comprobar cÃ³mo varÃ­a la frecuencia del movimiento circular de una partÃ­cula que se mueve en un campo magnÃ©tico homogÃ©neo en funciÃ³n de su velocidad cuando se aproxima a la velocidad de la luz $c \simeq 3\cdot 10^8~[m\cdot s^{-1}]$.

Para resolver este problema elegiremos una partÃ­cula, en nuestro caso el protÃ³n, y escogeremos para la misma una serie de valores para la velocidad (entre $1\cdot 10^2~[m\cdot s^{-1}]$ y $1\cdot 10^84[m\cdot s^{-1}]$) asÃ­ como el campo magnÃ©tico fijo. De esta forma, los datos de entrada serÃ¡n los siguientes:

\begin{itemize}
    \item Masa $m = 1.673\cdot 10^{-27}~[kg]$ y carga $q = 1.602\cdot 10^{-19}~[C]$ de la partÃ­cula (protÃ³n).
    \item Velocidades de la partÃ­cula $1\cdot 10^2~[m\cdot s^{-1}]$, $0.2\cdot 10^8~[m\cdot s^{-1}]$, $0.6\cdot 10^8~[m\cdot s^{-1}]$, $0.8\cdot 10^8~[m\cdot s^{-1}]$ y $1\cdot 10^8~[m\cdot s^{-1}]$.
    \item Campo magnÃ©tico $B = 1~[T]$.
\end{itemize}

\subsection{CÃ¡lculos AnalÃ­ticos}

En primer lugar, trataremos de obtener el radio de la curva que describe el protÃ³n en el seno de un campo magnÃ©tico (por ejemplo, dentro del selector de velocidades o en las Ds de un ciclotrÃ³n tal y como veremos en la siguiente secciÃ³n). Dicho campo magnÃ©tico provoca la apariciÃ³n de una fuerza magnÃ©tica sobre la partÃ­cula ya que esta se desplaza con velocidad perpendicular al mismo. Esta fuerza hace que describa un movimiento circular cuyo radio podemos determinar como en el caso del espectrÃ³metro de masas para velocidades no relativistas

\begin{equation}
F_m = ma_c \Rightarrow qvB = m \displaystyle\frac{v^2}{r} \Rightarrow r = \displaystyle\frac{mv}{qB}~[m]~.
\end{equation}

Para el caso de velocidades relativistas, la fÃ³rmula es idÃ©ntica pero reemplazando la masa invariante $m$ por la masa relativista $m\gamma$ siendo la constante

\begin{equation}
\gamma = \displaystyle\frac{1}{\sqrt{(1-\displaystyle\frac{v^2}{c^2})}},
\end{equation}

por lo tanto el radio de curvatura en el caso relativista es

\begin{equation}
r_\gamma = \displaystyle\frac{m\gamma v}{qB} = \displaystyle\frac{mv}{qB\sqrt{(1-\displaystyle\frac{v^2}{c^2})}}~[m]~.
\end{equation}

El perÃ­odo se puede calcular para el caso no relativista como

\begin{equation}
T = \displaystyle\frac{2\pi r}{v} = \displaystyle\frac{2\pi mv}{qBv} = \displaystyle\frac{2\pi m}{qB}~[s]~.
\end{equation}

Como podemos comprobar, no depende de la velocidad. El anÃ¡logo relativista sÃ­ que depende de la misma puesto que la masa lo hace

\begin{equation}
T_\gamma = \displaystyle\frac{2\pi m\gamma}{qB} = \displaystyle\frac{2\pi m}{qB\sqrt{(1-\displaystyle\frac{v^2}{c^2})}} ~[s]~.
\end{equation}

La frecuencia en ambos casos es la inversa del perÃ­odo

\begin{equation}
    f = \displaystyle\frac{1}{T} = \displaystyle\frac{qB}{2\pi m}~[Hz]~.
\end{equation}

\begin{equation}
    f_\gamma = \displaystyle\frac{1}{T_\gamma} = \displaystyle\frac{qB\sqrt{(1-\displaystyle\frac{v^2}{c^2})}}{2\pi m}~[Hz]~.
\end{equation}

\subsubsection{$v_1 = 1.0\cdot 10^2~[m\cdot s^{-1}]$}

Para la primera velocidad seleccionada estamos ante un caso no relativista. Dada la escasa velocidad, la constante $\gamma$ se aproxima a $1.00$ por lo que la masa relativista es prÃ¡cticamente igual a la masa invariante

\begin{equation}
\gamma_1 = \displaystyle\frac{1}{\sqrt{(1-\displaystyle\frac{v_1^2}{c^2})}} = \displaystyle\frac{1}{\sqrt{(1-\displaystyle\frac{(1.0\cdot 10^2)^2}{(3\cdot 10^8)^2})}} \simeq 1.000
\end{equation}

Su radio de curvatura es por lo tanto

\begin{equation}
r_1 = \displaystyle\frac{mv_1}{qB} = \displaystyle\frac{1.673\cdot 10^{-27}\cdot 1.000\cdot 10^2}{1.602\cdot 10^{-19}\cdot 1.000} = 1.044\cdot 10^{-6}~[m]~.
\end{equation}

Su perÃ­odo es

\begin{equation}
T_1 = \displaystyle\frac{2\pi m}{qB} = \displaystyle\frac{2\pi \cdot 1.673\cdot 10^{-27}}{1.602\cdot 10^{-19}\cdot 1.000} = 6.562\cdot 10^{-8}~[s]~,
\end{equation}

y por lo tanto la frecuencia es

\begin{equation}
f_1 = \displaystyle\frac{1}{T_1} = \displaystyle\frac{1}{6.562\cdot 10^{-8}} = 1.524\cdot 10^7~[Hz]~.
\end{equation}

\subsubsection{$v_2 = 0.2\cdot 10^8~[m\cdot s^{-1}]$}

Para la segunda velocidad seleccionada nos encontramos ante un caso relativista. La velocidad cercana a la velocidad de la luz hace que la constante $\gamma$ sea superior a $1.00$ por lo que la masa relativista es mayor que la masa invariante 

\begin{equation}
\gamma_2 = \displaystyle\frac{1}{\sqrt{(1-\displaystyle\frac{v_2^2}{c^2})}} = \displaystyle\frac{1}{\sqrt{(1-\displaystyle\frac{(0.2\cdot 10^8)^2}{(3\cdot 10^8)^2})}} \simeq 1.002
\end{equation}

Su radio de curvatura es por lo tanto

\begin{equation}
r_2 = \displaystyle\frac{m\gamma_2v_2}{qB} = \displaystyle\frac{1.67\cdot 10^{-27}\cdot 1.002 \cdot 0.200\cdot 10^8}{1.603\cdot 10^{-19}\cdot 1.000} = 2.093\cdot 10^{-1}~[m]~.
\end{equation}

Su perÃ­odo es

\begin{equation}
T_2 = \displaystyle\frac{2\pi m\gamma_2}{qB} = \displaystyle\frac{2\pi \cdot 1.67\cdot 10^{-27}\cdot 1.002}{1.6\cdot 10^{-19}\cdot 1.000} = 6.575\cdot 10^{-8}~[s]~,
\end{equation}

y por lo tanto la frecuencia es

\begin{equation}
f_2 = \displaystyle\frac{1}{T_2} = \displaystyle\frac{1}{6.575\cdot 10^{-8}} = 1.521\cdot 10^7~[Hz]~.
\end{equation}


\subsubsection{$v_3 = 0.6\cdot 10^8~[m\cdot s^{-1}]$}

Para la tercera velocidad, la constante $\gamma$ es todavÃ­a mayor

\begin{equation}
\gamma_3 = \displaystyle\frac{1}{\sqrt{(1-\displaystyle\frac{v_3^2}{c^2})}} = \displaystyle\frac{1}{\sqrt{(1-\displaystyle\frac{(0.600\cdot 10^8)^2}{(3.000\cdot 10^8)^2})}} \simeq 1.020
\end{equation}

Su radio de curvatura es por lo tanto

\begin{align}
r_3 = \displaystyle\frac{m\gamma_3v_3}{qB} = \displaystyle\frac{1.673\cdot 10^{-27}\cdot 1.020 \cdot 0.600\cdot 10^8}{1.602\cdot 10^{-19}\cdot 1.000} = \\
= 6.391\cdot 10^{-1}~[m]~.
\end{align}

Su perÃ­odo es

\begin{equation}
    T_3 = \displaystyle\frac{2\pi m\gamma_3}{qB} = \displaystyle\frac{2\pi \cdot 1.673\cdot 10^{-27}\cdot 1.020}{1.602\cdot 10^{-19}\cdot 1.000} = 6.693\cdot 10^{-8}~[s]~,
\end{equation}

y por lo tanto la frecuencia es

\begin{equation}
f_3 = \displaystyle\frac{1}{T_3} = \displaystyle\frac{1}{6.693\cdot 10^{-8}} = 1.494\cdot 10^7~[Hz]~.
\end{equation}

\subsubsection{$v_4 = 0.8\cdot 10^8~[m\cdot s^{-1}]$}

En el caso de la cuarta velocidad, $\gamma$ continÃºa creciendo

\begin{equation}
\gamma_4 = \displaystyle\frac{1}{\sqrt{(1-\displaystyle\frac{v_4^2}{c^2})}} = \displaystyle\frac{1}{\sqrt{(1-\displaystyle\frac{(0.8\cdot 10^8)^2}{(3\cdot 10^8)^2})}} \simeq 1.037
\end{equation}

Su radio de curvatura es por lo tanto

\begin{align}
r_4 = \displaystyle\frac{m\gamma_4v_4}{qB} = \displaystyle\frac{1.673\cdot 10^{-27}\cdot 1.037 \cdot 0.800\cdot 10^8}{1.602\cdot 10^{-19}\cdot 1.000} = \\
= 8.664\cdot 10^{-1}~[m]~.
\end{align}

Su perÃ­odo es

\begin{equation}
T_4 = \displaystyle\frac{2\pi m\gamma_4}{qB} = \displaystyle\frac{2\pi \cdot 1.673\cdot 10^{-27}\cdot 1.037}{1.602\cdot 10^{-19}\cdot 1.000} = 6.804\cdot 10^{-8}~[s]~,
\end{equation}

y por lo tanto la frecuencia es

\begin{equation}
f_4 = \displaystyle\frac{1}{T_4} = \displaystyle\frac{1}{6.804\cdot 10^{-8}} = 1.470\cdot 10^7~[Hz]~.
\end{equation}

\subsubsection{$v_5 = 1.0\cdot 10^8~[m\cdot s^{-1}]$}

La quinta velocidad posee la constante $\gamma$ mÃ¡s elevada

\begin{equation}
\gamma_5 = \displaystyle\frac{1}{\sqrt{(1-\displaystyle\frac{v_5^2}{c^2})}} = \displaystyle\frac{1}{\sqrt{(1-\displaystyle\frac{(1.0\cdot 10^8)^2}{(3\cdot 10^8)^2})}} \simeq 1.061
\end{equation}

Su radio de curvatura es por lo tanto

\begin{align}
r_5 = \displaystyle\frac{m\gamma_5v_5}{qB} = \displaystyle\frac{1.673\cdot 10^{-27}\cdot 1.061 \cdot 1.000\cdot 10^8}{1.602\cdot 10^{-19}\cdot 1.000} = \\
= 1.108~[m]~.
\end{align}

Su perÃ­odo es

\begin{equation}
T_5 = \displaystyle\frac{2\pi m\gamma_5}{qB} = \displaystyle\frac{2\pi \cdot 1.673\cdot 10^{-27}\cdot 1.061}{1.602\cdot 10^{-19}\cdot 1.000} = 6.962\cdot 10^{-8}~[s]~,
\end{equation}

y por lo tanto la frecuencia es

\begin{equation}
f_5 = \displaystyle\frac{1}{T_5} = \displaystyle\frac{1}{6.962\cdot 10^{-8}} = 1.436\cdot 10^7~[Hz]~.
\end{equation}

\subsection{SimulaciÃ³n}

La simulaciÃ³n del movimiento del protÃ³n con velocidad no relativista y velociades relativista se muestra en las Figuras \ref{fig:freqrelt0}, \ref{fig:freqrelt1}, \ref{fig:freqrelt2}, \ref{fig:freqrelt3}, \ref{fig:freqrelt4} respectivamente para las velocidades $1\cdot 10^2~[m\cdot s^{-1}]$, $0.2\cdot 10^8~[m\cdot s^{-1}]$, $0.6\cdot 10^8~[m\cdot s^{-1}]$, $0.8\cdot 10^8~[m\cdot s^{-1}]$ y $1\cdot 10^8~[m\cdot s^{-1}]$. El cÃ³digo proporcionado ha sido modificado para encontrar los dos mÃ­nimos mÃ¡s prÃ³ximos en la simulaciÃ³n y calcular el perÃ­odo dados los instantes temporales de dichos valores. En todas las figuras antes mencionadas se muestra el perÃ­odo estimado $T^s$ asÃ­ como la lÃ­nea que une los dos instantes temporales utilizados para su cÃ¡lculo. El CÃ³digo \ref{listing:datos_frecuencia} muestra los datos empleados en el programa de simulaciÃ³n.

\bigskip

\begin{code}
    \begin{minted}{python}
m=1.673e-27  # masa del ion
q=1.602e-19   # Carga del ion
B=1.0  # Campo magnÃ©tico
#Ecr=(np.random.rand())*40+10
#Ec=round(Ecr,2)
vx0=1.0e2  # velocidad del ion
tf=12e-8  #tiempo de simulacion
    \end{minted}
    \caption{Datos de simulaciÃ³n para estudio de frecuencias a velocidades relativistas. El valor \mintinline{python}{vx0} cambiarÃ¡ segÃºn la velocidad a estudiar.}
    \label{listing:datos_frecuencia}
\end{code}

\begin{figure}[!htb]
    \centering
    \includegraphics[width=\linewidth]{freq_rel_t_0.png}
    \caption{VariaciÃ³n de la coordenada del protÃ³n para velocidad no relativista $v = 1\cdot 10^2~[m\cdot s^{-1}]$.}
    \label{fig:freqrelt0}
\end{figure}

\newpage

\hfill

\begin{figure}[!htb]
    \centering
    \includegraphics[width=\linewidth]{freq_rel_t_1.png}
    \caption{VariaciÃ³n de la coordenada del protÃ³n para velocidad relativista $v = 0.2\cdot 10^8~[m\cdot s^{-1}]$.}
    \label{fig:freqrelt1}
\end{figure}

\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip

\begin{figure}[!htb]
    \centering
    \includegraphics[width=\linewidth]{freq_rel_t_2.png}
    \caption{VariaciÃ³n de la coordenada del protÃ³n para velocidad relativista $v = 0.6\cdot 10^8~[m\cdot s^{-1}]$.}
    \label{fig:freqrelt2}
\end{figure}

\hfill

\newpage

\hfill

\begin{figure}[!htb]
    \centering
    \includegraphics[width=\linewidth]{freq_rel_t_3.png}
    \caption{VariaciÃ³n de la coordenada del protÃ³n para velocidad relativista $v = 0.8\cdot 10^8~[m\cdot s^{-1}]$.}
    \label{fig:freqrelt3}
\end{figure}

\bigskip
\bigskip
\bigskip
\bigskip
\bigskip
\bigskip

\hfill

\begin{figure}[!htb]
    \centering
    \includegraphics[width=\linewidth]{freq_rel_t_4.png}
    \caption{VariaciÃ³n de la coordenada del protÃ³n para velocidad relativista $v = 1.0\cdot 10^8~[m\cdot s^{-1}]$.}
    \label{fig:freqrelt4}
\end{figure}

\hfill

\clearpage

Como podemos comprobar, los valores simulados para el perÃ­odo $T^s_1 = 6.563\cdot 10^{-8}~[s]$, $T^s_2 = 6.576\cdot 10^{-8}~[s]$, $T^s_3 = 6.690\cdot 10^{-8}~[s]$, $T^s_4 = 6.807\cdot 10^{-8}~[s]$ y $T^s_5 = 6.963\cdot 10^{-8}~[s]$ son prÃ¡cticamente similares a los obtenidos de forma teÃ³rica. La Figura \ref{fig:relativista_norelativista} muestra la comparativa de la variaciÃ³n de la frecuencia dependiendo de la velocidad para todos los casos anteriormente analizados tanto de forma teÃ³rica como de manera simulada. La Figura \ref{fig:relativista_norelativista_energia} muestra esta misma evoluciÃ³n pero en este caso en funciÃ³n de la energÃ­a cinÃ©tica en lugar de la velocidad.

\begin{figure}[!htb]
    \begin{tikzpicture}
        \begin{axis}[
            xlabel={Velocidad $[m\cdot s^{-1}]$},
            ylabel={Frecuencia $[Hz]$},
            xmin=0.0, xmax=1.0e8,
            ymin=1.4e7, ymax=1.54e7,
            enlargelimits=true,
            xtick={0,0.2e8, 0.4e8, 0.6e8, 0.8e8, 1.0e8},
            ytick={1.4e7,1.42e7,1.44e7,1.46e7,1.48e7,1.50e7, 1.52e7, 1.54e7},
            legend pos=south west,
            ymajorgrids=true,
            grid style=dashed,
        ]
         
        \addplot[
            color=blue,
            mark=none,
            ]
            coordinates {
            (0, 1.524e7)(0.2e8, 1.524e7)(0.6e8, 1.524e7)(0.8e8, 1.524e7)(1.0e8, 1.524e7)
            };

        \addplot[
                smooth,
                color=red,
                mark=square,
                ]
                coordinates {
                (0, 1.524e7)(0.2e8, 1.521e7)(0.6e8, 1.494e7)(0.8e8, 1.470e7)(1.0e8, 1.436e7)
                };
        \addplot[
                smooth,
                only marks,
                color=green,
                mark=*,
                ]
                coordinates {
                (0, 1.524e7)(0.2e8, 1.521e7)(0.6e8, 1.495e7)(0.8e8, 1.469e7)(1.0e8, 1.436e7)
                };
        \legend{No relativista (TeÃ³rico), Relativista (TeÃ³rico), Relativista (Simulado)}
        \end{axis}
    \end{tikzpicture}
    \caption{VariaciÃ³n de la frecuencia de ciclotrÃ³n $f~[Hz]$ en funciÃ³n de la energÃ­a cinÃ©tica $E_c~[J]$ del protÃ³n segÃºn los valores teÃ³ricos y simulados estudiados tanto para el caso relativista como para el no relativista.}
    \label{fig:relativista_norelativista}
\end{figure}

\begin{figure}[!htb]
    \begin{tikzpicture}
        \begin{axis}[
            xlabel={EnergÃ­a CinÃ©tica $[J]$},
            ylabel={Frecuencia $[Hz]$},
            ymin=1.4e7, ymax=1.54e7,
            enlargelimits=true,
            ytick={1.4e7,1.42e7,1.44e7,1.46e7,1.48e7,1.50e7, 1.52e7, 1.54e7},
            legend pos=south west,
            ymajorgrids=true,
            grid style=dashed,
        ]

        \addplot[
            color=blue,
            mark=none,
            ]
            coordinates {
            (8.365e-24, 1.524e7)(3.353e-13, 1.524e7)(3.072e-12, 1.524e7)(5.552e-12, 1.524e7)(8.875e-12, 1.524e7)
        };

        \addplot[
                smooth,
                color=red,
                mark=square,
                ]
                coordinates {
                (8.365e-24, 1.524e7)(3.353e-13, 1.521e7)(3.072e-12, 1.494e7)(5.552e-12, 1.470e7)(8.875e-12, 1.436e7)
                };

        \addplot[
            only marks,
            color=green,
            mark=*,
            ]
            coordinates {
            (8.365e-24, 1.524e7)(3.353e-13, 1.521e7)(3.072e-12, 1.495e7)(5.552e-12, 1.469e7)(8.875e-12, 1.436e7)
            };
        \legend{No relativista (TeÃ³rico), Relativista (TeÃ³rico), Relativista (Simulado)}
        \end{axis}
    \end{tikzpicture}
    \caption{VariaciÃ³n de la frecuencia de ciclotrÃ³n $f~[Hz]$ en funciÃ³n de la velocidad $v~[m\cdot s^{-1}]$ del protÃ³n segÃºn los valores teÃ³ricos y simulados estudiados tanto para el caso relativista como para el no relativista.}
    \label{fig:relativista_norelativista_energia}
\end{figure}


\newpage

\section{CiclotrÃ³n}
\label{sec:ciclotron}

En esta secciÃ³n de la prÃ¡ctica trataremos el movimiento de protones en un ciclotrÃ³n (ver Figura \ref{fig:ciclotron}), un instrumento en el que una partÃ­cula cargada es acelerada inicialmente desde el reposo mediante la acciÃ³n de un campo elÃ©ctrico existente en la regiÃ³n de separaciÃ³n entre los dos semicÃ­rculos denominados $Ds$ del ciclotrÃ³n. En los semicÃ­rculos existe un campo magnÃ©tico que les produce un movimiento circular cuyo radio depende de la velocidad con la que provengan de la regiÃ³n del campo elÃ©ctrico que los ha acelerado. Ese movimiento circular les hace volver a la regiÃ³n del campo elÃ©ctrico que varÃ­a de manera periÃ³dica para acelerar los protones hacia la $D$ opuesta. Con el tiempo y tras varios pasos por la regiÃ³n del campo elÃ©ctrico y por las $D$ las partÃ­culas son capaces de ganar grandes cantidades de energÃ­a y alcanzar velocidades tremendamente elevadas.

\begin{figure}[!htb]
    \includegraphics[width=1\linewidth]{ciclotron.png}
    \caption{RepresentaciÃ³n esquemÃ¡tica del ciclotrÃ³n con un campo magnÃ©tico $B$, radio $R$ y distancia $d$.}
    \label{fig:ciclotron}
\end{figure}

Para resolver este problemas fijaremos tanto un campo elÃ©ctrico $E$ entre las Ds del ciclotrÃ³n, asÃ­ como un campo magnÃ©tico $B$ en las mismas. Definiremos tambiÃ©n la distancia entre las Ds y su radio. Calcularemos el perÃ­odo del movimiento circular, asÃ­ como el tiempo que tarda la partÃ­cula en atravesar la regiÃ³n de campo elÃ©ctrico y la energÃ­a que ganarÃ¡ cada vez que pase entre las Ds. Para el cÃ¡lculo tanto analÃ­tico como simulado utilizaremos los siguientes datos de entrada:

\begin{itemize}
    \item Masa $m = 1.67\cdot 10^{-27}~[kg]$ y carga $q = 1.60\cdot 10^{-19}~[C]$ del protÃ³n.
    \item Campo magnÃ©tico $B = 1\cdot 10^{-1}~[T]$ en las Ds.
    \item Diferencia de potencial $V = 5\cdot 10^3~[V]$ entre las Ds.
    \item Distancia entre las Ds $d = 2\cdot 10^{-2}~[m]$.
    \item Radio de las Ds $r = 2.5\cdot 10^{-1}~[m]$.
\end{itemize}

\newpage

\subsection{CÃ¡lculos AnalÃ­ticos}

Para poder obtener el perÃ­odo del movimiento circular no relativista que ocurre en las Ds del ciclotrÃ³n deberemos en primer lugar calcular el radio de curvatura de la trayectoria descrita. Para ello sabemos que es la fuerza magnÃ©tica la que provoca la aceleraciÃ³n que induce el movimiento circular en la partÃ­cula, por lo tanto

\begin{equation}
F_m = ma_c \Rightarrow qvB = m \displaystyle\frac{v^2}{r} \Rightarrow r = \displaystyle\frac{mv}{qB}~[m]~,
\end{equation}

asÃ­ que podemos utilizar esta expresiÃ³n para determinar el perÃ­odo (el cual no depende de la velocidad)

\begin{equation}
T = \displaystyle\frac{2\pi r}{v} = \displaystyle\frac{2\pi mv}{qBv} = \displaystyle\frac{2\pi m}{qB}~[s]~.
\end{equation}

El tiempo que tarda un protÃ³n en reposo en atravesar la zona de las Ds podemos obtenerlo teniendo en cuenta que Ãºnicamente la fuerza elÃ©ctrica provoca una aceleraciÃ³n sobre el mismo

\begin{equation}
F_e = ma \Rightarrow qE = ma \Rightarrow a = \displaystyle\frac{qE}{m}~[m\cdot s^{-2}]~,
\end{equation}

teniendo en cuenta que $V = Ed$

\begin{equation}
a = \displaystyle\frac{qE}{m} = \displaystyle\frac{qV}{md}~[m\cdot s^{-2}]~.
\end{equation}

La fuerza elÃ©ctrica provoca un movimiento uniformemente acelerado (teniendo en cuenta que el protÃ³n en reposo se encuentra equidistante a ambas Ds, la distancia que tendrÃ¡ que recorrer serÃ¡ $0.5d$)

\begin{equation}
x = x_0 + v_0t + \displaystyle\frac{1}{2}at^2 \Rightarrow \displaystyle\frac{d}{2} = \displaystyle\frac{1}{2}at^2 \Rightarrow t = \sqrt{\displaystyle\frac{md^2}{qV}}~[s]~.
\end{equation}

Esta aceleraciÃ³n provocada en el iÃ³n al atravesar el campo elÃ©ctrico incrementa su energÃ­a cinÃ©tica en una cantidad igual al producto de su carga por la diferencia de potencial entre las Ds del ciclotrÃ³n

\begin{equation}
\Delta E_c = \displaystyle\frac{1}{2}mv_f^2 - \displaystyle\frac{1}{2}mv_0^2 = qV~[J]~.
\end{equation}

Para el caso que nos ocupa, un protÃ³n tendrÃ¡ el siguiente perÃ­odo de movimiento circular no relativista

\begin{equation}
T = \displaystyle\frac{2\pi m}{qB} = \displaystyle\frac{2\pi 1.67\cdot10^{-27}}{1.60\cdot 10^{-19}\cdot 2.00\cdot 10^{-1}} = 6.56\cdot 10^{-7}~[s]~.
\end{equation}

El tiempo que tarda un protÃ³n en reposo en atravesar la zona entre las dos Ds es de

\begin{equation}
t = \sqrt{\displaystyle\frac{md^2}{qV}} = \sqrt{\displaystyle\frac{1.67\cdot 10^{-27}\cdot (1.00\cdot 10^{-2})^2}{1.60\cdot 10^{-19}\cdot 5\cdot 10^3}} = 2.89\cdot 10^{-8}~[s]~.
\end{equation}

Cada vez que pasa entre las Ds, el protÃ³n gana energÃ­a cinÃ©tica dada la aceleraciÃ³n uniforme sufrida

\begin{equation}
\Delta E_c = qV = 1.60\cdot 10^{-19} \cdot 5\cdot 10^3 = 8\cdot 10^{-16}~[J]~,
\end{equation}

al partir del reposo Ãºnicamente recorre la mitad de la distancia por lo que gana la mitad de la energÃ­a $\Delta_0 E_c = 0.5 \Delta E_c = 4\cdot 10^{-16}~[J]$.

\subsection{SimulaciÃ³n}

En primer lugar, simularemos las condiciones anteriores (ver CÃ³digo \ref{listing:ciclotron_datos}) para la aceleraciÃ³n de un protÃ³n en reposo. La Figura \ref{fig:ciclotron_simulacion} muestra el resultado de esta simulaciÃ³n (tanto la trayectoria seguida por el protÃ³n como la evoluciÃ³n de la energÃ­a cinÃ©tica del mismo).

\bigskip

\begin{code}
    \begin{minted}{python}
m=1.67e-27 # masa del ion
q=1.60e-19 #carga del ion
Bf=1e-1 # Campo magnÃ©tico existente en las Ds
dV=5e3 # Diferencia de potencial entre las Ds
dE=2e-2 # Separacion entre las Ds 
Ef=dV/dE #Campo electrico entre las Ds
omega=qm*Bf #frecuencia angular del voltaje
Rc=2.5e-1 #Radio de las Ds del ciclotron
tf=49e-7 # tiempo final de simulacion
    \end{minted}
    \caption{Datos para simulaciÃ³n de ciclotrÃ³n.}
    \label{listing:ciclotron_datos}
\end{code}

\begin{figure}[!htb]
    \centering
    \includegraphics[width=\linewidth]{ciclotron_simulacion.png}
    \caption{Resultado de la simulaciÃ³n del protÃ³n en el ciclotrÃ³n mostrando su trayectoria hasta escapar del ciclotrÃ³n (arriba) y la evoluciÃ³n de la energÃ­a cinÃ©tica (abajo).}
    \label{fig:ciclotron_simulacion}
\end{figure}

\clearpage

Como podemos comprobar, el protÃ³n atraviesa la regiÃ³n entre las Ds en un total de cuatro ocasiones ademÃ¡s de la mitad del recorrido que realiza desde el reposo. De acuerdo a nuestro anÃ¡lisis teÃ³rico, la energÃ­a cinÃ©tica alcanzada por el protÃ³n deberÃ­a de ser de $4\Delta E_c + \Delta_0 E_c = 4\cdot 8\cdot 10^{-16} + 4\cdot 10^{-16} = 3.6\cdot 10^{-15}~[J]$. Este cÃ¡lculo analÃ­tico coincide con el resultado simulado mostrado en la Figura \ref{fig:ciclotron_simulacion}.

A continuaciÃ³n comprobaremos el efecto de la distancia de separaciÃ³n entre las Ds en el protÃ³n y su evoluciÃ³n. De forma analÃ­tica demostramos que esta distancia afecta al tiempo que tarda el protÃ³n en atravesar la regiÃ³n de separaciÃ³n pero que no tiene ningÃºn efecto sobre el perÃ­odo del movimiento circular ni sobre la energÃ­a cinÃ©tica ganada al atravesar la regiÃ³n antes mencionada. Las Figuras \ref{fig:ciclotron_simulacion_d4} y \ref{fig:ciclotron_simulacion_d8} muestran el resultado de la simulaciÃ³n cuando incrementamos la distancia de separaciÃ³n de $2\cdot 10^-2~[m]$ a $4\cdot 10^{-2}~[m]$ y $8\cdot 10^{-2}~[m]$ respectivamente.

\begin{figure}[!htb]
    \centering
    \includegraphics[width=0.9\linewidth]{ciclotron_simulacion_d4.png}
    \caption{Resultado de la simulaciÃ³n del protÃ³n en el ciclotrÃ³n mostrando su trayectoria hasta escapar del ciclotrÃ³n (arriba) y la evoluciÃ³n de la energÃ­a cinÃ©tica (abajo). En este caso, la distancia de separaciÃ³n entre las Ds ha sido aumentada de de $2\cdot 10^-2~[m]$ a $4\cdot 10^{-2}~[m]$.}
    \label{fig:ciclotron_simulacion_d4}
\end{figure}

\begin{figure}[!tb]
    \centering
    \includegraphics[width=0.9\linewidth]{ciclotron_simulacion_d8.png}
    \caption{Resultado de la simulaciÃ³n del protÃ³n en el ciclotrÃ³n mostrando su trayectoria tras describir varios curvas en el ciclotrÃ³n (arriba) y la evoluciÃ³n de la energÃ­a cinÃ©tica (abajo). En este caso, la distancia de separaciÃ³n entre las Ds ha sido aumentada de de $2\cdot 10^-2~[m]$ a $8\cdot 10^{-2}~[m]$.}
    \label{fig:ciclotron_simulacion_d8}
\end{figure}

Como podemos observar, efectivamente la distancia de separaciÃ³n no tiene efecto sobre la energÃ­a cinÃ©tica mÃ¡xima alcanzada ni sobre el perÃ­odo del movimiento circular descrito por el protÃ³n. SÃ­ que tiene un efecto sobre el movimiento del mismo puesto que, si la distancia es suficientemente grande, el tiempo que el protÃ³n emplea en atravesar la regiÃ³n del campo elÃ©ctrico no es despreciable respecto al tiempo que pasa en las Ds por lo que se produce un desfase entre el voltaje de la fuente alterna y el movimiento del iÃ³n, lo cual provoca a su vez que el iÃ³n no siempre se acelere en la regiÃ³n de campo elÃ©ctrico sino que como este se opone en ocasiones a su movimiento (fuera de fase) se frena y no se consigue el efecto deseado de acelerar la partÃ­cula constantemente. La Figura \ref{fig:ciclotron_simulacion_d4} muestra un caso en el que la distancia no es lo suficientemente grande como para provocar ese desfase, mientras que en el caso de la Figura \ref{fig:ciclotron_simulacion_d8} sÃ­ que ocurre este fenÃ³meno.

Por Ãºltimo, estudiaremos el efecto que produce la variaciÃ³n de la frecuencia de voltaje alterno respecto al valor Ã³ptimo establecido para la simulaciÃ³n. En concreto, analizaremos las situaciones en las que la frecuencia de voltaje alterno es un $50\%$ mayor y un $50\%$ menor del valor Ã³ptimo. El resultado de la simulaciÃ³n para una frecuencia un $50\%$ mayor se muestra en la Figura \ref{fig:ciclotron_simulacion_w150} mientras que la simulaciÃ³n para la frecuencia un $50\%$ menor queda representada en la Figura \ref{fig:ciclotron_simulacion_w50}.

En ambos casos ocurre un problema similar a cuando incrementamos suficientemente la distancia entre las Ds: existe un desfase entre la frecuencia del voltaje alterno y el movimiento del iÃ³n de forma que no siempre se acelera al atravesar la regiÃ³n de campo elÃ©ctrico sino que en ocasiones se frena e incluso llega a invertir el sentido de su trayectoria.

\begin{figure}[!htb]
    \centering
    \includegraphics[width=0.9\linewidth]{ciclotron_simulacion_w150.png}
    \caption{Resultado de la simulaciÃ³n del protÃ³n en el ciclotrÃ³n mostrando su trayectoria (arriba) y la evoluciÃ³n de la energÃ­a cinÃ©tica del mismo (abajo). La frecuencia de voltaje alterno es un $150\%$ de la frecuencia Ã³ptima previamente establecida.}
    \label{fig:ciclotron_simulacion_w150}
\end{figure}

En el caso de la Figura \ref{fig:ciclotron_simulacion_w150} en el que la frecuencia del voltaje es un $150\%$ respecto a la frecuencia Ã³ptima podemos observar cÃ³mo la energÃ­a cinÃ©tica oscila de forma que el protÃ³n es frenado en ocasiones por lo que su trayectoria no sigue el movimiento circular esperado en el ciclotrÃ³n.

Por otro lado, en la situaciÃ³n mostrada en la Figura \ref{fig:ciclotron_simulacion_w50} en la que disminuÃ­mos la frecuencia de voltaje hasta un $50\%$ de la Ã³ptima, podemos observar cÃ³mo tras describir la primera curva el protÃ³n entra de nuevo en la regiÃ³n de campo elÃ©ctrico y es frenado e incluso invierte el sentido de su movimiento regresando a la D de la cual proviene. En este caso tampoco se produce el comportamiento esperado en un ciclotrÃ³n.

En definitiva, todas las simulaciones realizadas constatan la importancia de elegir tanto una distancia adecuada para las Ds como una frecuencia de voltaje alterno Ã³ptima para producir el comportamiento deseado en el protÃ³n y en general en cualquier iÃ³n que se deje en reposo en el centro del ciclotrÃ³n.

\begin{figure}[!htb]
    \centering
    \includegraphics[width=0.9\linewidth]{ciclotron_simulacion_w50.png}
    \caption{Resultado de la simulaciÃ³n del protÃ³n en el ciclotrÃ³n mostrando su trayectoria hasta escapar del ciclotrÃ³n (arriba) y la evoluciÃ³n de la energÃ­a cinÃ©tica del mismo (abajo). La frecuencia de voltaje alterno es un $50\%$ de la frecuencia Ã³ptima previamente establecida.}
    \label{fig:ciclotron_simulacion_w50}
\end{figure}

Por Ãºltimo, otra posibilidad a comentar es el hecho de que los iones dentro del ciclotrÃ³n (en nuestro caso el protÃ³n) alcancen velocidades relativistas. En la SecciÃ³n \ref{sec:frecuencia} estudiamos el efecto de la velocidad sobre la frecuencia de ciclotrÃ³n y determinamos que, para situaciones relativistas, el perÃ­odo aumentaba con la velocidad (ya que la masa relativista aumentaba respecto a la masa invariante) y por lo tanto la frecuencia de ciclotrÃ³n disminuye. De la misma forma, el radio de curvatura era proporcional a la masa de la partÃ­cula por lo que este aumentaba conforme aumentaba la velocidad de la misma. Este hecho conlleva una problemÃ¡tica y es que al variar el perÃ­odo del movimiento circular manteniendo la frecuencia de voltaje alterno fija eventualmente se producirÃ¡ un desfase entre dicha frecuencia y el movimiento del protÃ³n que provocarÃ¡ problemas como los sucedidos en las simulaciones anteriores. Dos posibles soluciones a esta eventualidad pueden ser o bien variar la frecuencia de voltaje alterno para mantener la fase con la trayectoria del protÃ³n o bien aumentar con cada paso por la regiÃ³n de campo elÃ©ctrico la intensidad del campo magnÃ©tico en las Ds para compensar el incremento de masa relativista provocado por el aumento de velocidad gracias a la fuerza elÃ©ctrica y asÃ­ mantener el perÃ­odo y la frecuencia de ciclotrÃ³n constantes a lo largo de toda la trayectoria.

\section{ConclusiÃ³n}
\label{sec:conclusion}
En esta primera prÃ¡ctica de la asignatura hemos presentado un estudio del movimiento de varios tipos de cargas en campos electromagnÃ©ticos producidos por diversos instrumentos utilizados en la actualidad. Para cada uno de ellos hemos llevado a cabo una soluciÃ³n analÃ­tica que posteriormente ha sido contrastada con simulaciones en las que hemos explorado el efecto de varios de los parÃ¡metros que rigen dicho instrumental.

Gracias a la realizaciÃ³n de esta prÃ¡ctica y de su informe hemos consolidado en gran medida el conocimiento sobre campos electromagnÃ©ticos y su efecto sobre diferentes partÃ­culas asÃ­ como de otros tantos valores (frecuencias, perÃ­odos, radios de curvatura y energÃ­as).

\clearpage

El cÃ³digo Python que implementa esta prÃ¡ctica asÃ­ como las fuentes \LaTeX de este informe se encuentran disponibles online en el repositorio \url{https://github.com/Blitzman/physics/tree/master/fisica_2/practica_1}.


\end{document}
